var HighFidelityAudio;HighFidelityAudio=(()=>{"use strict";var __webpack_modules__={591:(e,t,i)=>{const{Deflate:n,deflate:a,deflateRaw:s,gzip:o}=i(555),{Inflate:r,inflate:l,inflateRaw:d,ungzip:h}=i(843),u=i(619);e.exports.Deflate=n,e.exports.deflate=a,e.exports.deflateRaw=s,e.exports.gzip=o,e.exports.Inflate=r,e.exports.inflate=l,e.exports.inflateRaw=d,e.exports.ungzip=h,e.exports.constants=u},555:(e,t,i)=>{const n=i(405),a=i(236),s=i(373),o=i(898),r=i(292),l=Object.prototype.toString,{Z_NO_FLUSH:d,Z_SYNC_FLUSH:h,Z_FULL_FLUSH:u,Z_FINISH:c,Z_OK:_,Z_STREAM_END:m,Z_DEFAULT_COMPRESSION:g,Z_DEFAULT_STRATEGY:f,Z_DEFLATED:p}=i(619);function v(e){this.options=a.assign({level:g,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;let i=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==_)throw new Error(o[i]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=n.deflateSetDictionary(this.strm,e),i!==_)throw new Error(o[i]);this._dict_set=!0}}function w(e,t){const i=new v(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(e,t){const i=this.strm,a=this.options.chunkSize;let o,r;if(this.ended)return!1;for(r=t===~~t?t:!0===t?c:d,"string"==typeof e?i.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),(r===h||r===u)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(o=n.deflate(i,r),o===m)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=n.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===_;if(0!==i.avail_out){if(r>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===_&&(this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Deflate=v,e.exports.deflate=w,e.exports.deflateRaw=function(e,t){return(t=t||{}).raw=!0,w(e,t)},e.exports.gzip=function(e,t){return(t=t||{}).gzip=!0,w(e,t)},e.exports.constants=i(619)},843:(e,t,i)=>{const n=i(948),a=i(236),s=i(373),o=i(898),r=i(292),l=i(401),d=Object.prototype.toString,{Z_NO_FLUSH:h,Z_FINISH:u,Z_OK:c,Z_STREAM_END:_,Z_NEED_DICT:m,Z_STREAM_ERROR:g,Z_DATA_ERROR:f,Z_MEM_ERROR:p}=i(619);function v(e){this.options=a.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new r,this.strm.avail_out=0;let i=n.inflateInit2(this.strm,t.windowBits);if(i!==c)throw new Error(o[i]);if(this.header=new l,n.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=s.string2buf(t.dictionary):"[object ArrayBuffer]"===d.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=n.inflateSetDictionary(this.strm,t.dictionary),i!==c)))throw new Error(o[i])}function w(e,t){const i=new v(t);if(i.push(e),i.err)throw i.msg||o[i.err];return i.result}v.prototype.push=function(e,t){const i=this.strm,a=this.options.chunkSize,o=this.options.dictionary;let r,l,v;if(this.ended)return!1;for(l=t===~~t?t:!0===t?u:h,"[object ArrayBuffer]"===d.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(a),i.next_out=0,i.avail_out=a),r=n.inflate(i,l),r===m&&o&&(r=n.inflateSetDictionary(i,o),r===c?r=n.inflate(i,l):r===f&&(r=m));i.avail_in>0&&r===_&&i.state.wrap>0&&0!==e[i.next_in];)n.inflateReset(i),r=n.inflate(i,l);switch(r){case g:case f:case m:case p:return this.onEnd(r),this.ended=!0,!1}if(v=i.avail_out,i.next_out&&(0===i.avail_out||r===_))if("string"===this.options.to){let e=s.utf8border(i.output,i.next_out),t=i.next_out-e,n=s.buf2string(i.output,e);i.next_out=t,i.avail_out=a-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(n)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(r!==c||0!==v){if(r===_)return r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},v.prototype.onData=function(e){this.chunks.push(e)},v.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},e.exports.Inflate=v,e.exports.inflate=w,e.exports.inflateRaw=function(e,t){return(t=t||{}).raw=!0,w(e,t)},e.exports.ungzip=w,e.exports.constants=i(619)},236:e=>{const t=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);e.exports.assign=function(e){const i=Array.prototype.slice.call(arguments,1);for(;i.length;){const n=i.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(const i in n)t(n,i)&&(e[i]=n[i])}}return e},e.exports.flattenChunks=e=>{let t=0;for(let i=0,n=e.length;i<n;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,n=0,a=e.length;t<a;t++){let a=e[t];i.set(a,n),n+=a.length}return i}},373:e=>{let t=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){t=!1}const i=new Uint8Array(256);for(let e=0;e<256;e++)i[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;i[254]=i[254]=1,e.exports.string2buf=e=>{let t,i,n,a,s,o=e.length,r=0;for(a=0;a<o;a++)i=e.charCodeAt(a),55296==(64512&i)&&a+1<o&&(n=e.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),r+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(r),s=0,a=0;s<r;a++)i=e.charCodeAt(a),55296==(64512&i)&&a+1<o&&(n=e.charCodeAt(a+1),56320==(64512&n)&&(i=65536+(i-55296<<10)+(n-56320),a++)),i<128?t[s++]=i:i<2048?(t[s++]=192|i>>>6,t[s++]=128|63&i):i<65536?(t[s++]=224|i>>>12,t[s++]=128|i>>>6&63,t[s++]=128|63&i):(t[s++]=240|i>>>18,t[s++]=128|i>>>12&63,t[s++]=128|i>>>6&63,t[s++]=128|63&i);return t},e.exports.buf2string=(e,n)=>{let a,s;const o=n||e.length,r=new Array(2*o);for(s=0,a=0;a<o;){let t=e[a++];if(t<128){r[s++]=t;continue}let n=i[t];if(n>4)r[s++]=65533,a+=n-1;else{for(t&=2===n?31:3===n?15:7;n>1&&a<o;)t=t<<6|63&e[a++],n--;n>1?r[s++]=65533:t<65536?r[s++]=t:(t-=65536,r[s++]=55296|t>>10&1023,r[s++]=56320|1023&t)}}return((e,i)=>{if(i<65534&&e.subarray&&t)return String.fromCharCode.apply(null,e.length===i?e:e.subarray(0,i));let n="";for(let t=0;t<i;t++)n+=String.fromCharCode(e[t]);return n})(r,s)},e.exports.utf8border=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let n=t-1;for(;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+i[e[n]]>t?n:t}},69:e=>{e.exports=(e,t,i,n)=>{let a=65535&e|0,s=e>>>16&65535|0,o=0;for(;0!==i;){o=i>2e3?2e3:i,i-=o;do{a=a+t[n++]|0,s=s+a|0}while(--o);a%=65521,s%=65521}return a|s<<16|0}},619:e=>{e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},869:e=>{const t=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());e.exports=(e,i,n,a)=>{const s=t,o=a+n;e^=-1;for(let t=a;t<o;t++)e=e>>>8^s[255&(e^i[t])];return-1^e}},405:(e,t,i)=>{const{_tr_init:n,_tr_stored_block:a,_tr_flush_block:s,_tr_tally:o,_tr_align:r}=i(342),l=i(69),d=i(869),h=i(898),{Z_NO_FLUSH:u,Z_PARTIAL_FLUSH:c,Z_FULL_FLUSH:_,Z_FINISH:m,Z_BLOCK:g,Z_OK:f,Z_STREAM_END:p,Z_STREAM_ERROR:v,Z_DATA_ERROR:w,Z_BUF_ERROR:S,Z_DEFAULT_COMPRESSION:b,Z_FILTERED:C,Z_HUFFMAN_ONLY:A,Z_RLE:y,Z_FIXED:x,Z_DEFAULT_STRATEGY:D,Z_UNKNOWN:I,Z_DEFLATED:k}=i(619),R=258,T=262,M=103,E=113,O=666,F=(e,t)=>(e.msg=h[t],t),P=e=>(e<<1)-(e>4?9:0),H=e=>{let t=e.length;for(;--t>=0;)e[t]=0};let N=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const U=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},z=(e,t)=>{s(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,U(e.strm)},L=(e,t)=>{e.pending_buf[e.pending++]=t},Q=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},B=(e,t,i,n)=>{let a=e.avail_in;return a>n&&(a=n),0===a?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),i),1===e.state.wrap?e.adler=l(e.adler,t,a,i):2===e.state.wrap&&(e.adler=d(e.adler,t,a,i)),e.next_in+=a,e.total_in+=a,a)},Z=(e,t)=>{let i,n,a=e.max_chain_length,s=e.strstart,o=e.prev_length,r=e.nice_match;const l=e.strstart>e.w_size-T?e.strstart-(e.w_size-T):0,d=e.window,h=e.w_mask,u=e.prev,c=e.strstart+R;let _=d[s+o-1],m=d[s+o];e.prev_length>=e.good_match&&(a>>=2),r>e.lookahead&&(r=e.lookahead);do{if(i=t,d[i+o]===m&&d[i+o-1]===_&&d[i]===d[s]&&d[++i]===d[s+1]){s+=2,i++;do{}while(d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&d[++s]===d[++i]&&s<c);if(n=R-(c-s),s=c-R,n>o){if(e.match_start=t,o=n,n>=r)break;_=d[s+o-1],m=d[s+o]}}}while((t=u[t&h])>l&&0!=--a);return o<=e.lookahead?o:e.lookahead},K=e=>{const t=e.w_size;let i,n,a,s,o;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-T)){e.window.set(e.window.subarray(t,t+t),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,n=e.hash_size,i=n;do{a=e.head[--i],e.head[i]=a>=t?a-t:0}while(--n);n=t,i=n;do{a=e.prev[--i],e.prev[i]=a>=t?a-t:0}while(--n);s+=t}if(0===e.strm.avail_in)break;if(n=B(e.strm,e.window,e.strstart+e.lookahead,s),e.lookahead+=n,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=N(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=N(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<T&&0!==e.strm.avail_in)},V=(e,t)=>{let i,n;for(;;){if(e.lookahead<T){if(K(e),e.lookahead<T&&t===u)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=N(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-T&&(e.match_length=Z(e,i)),e.match_length>=3)if(n=o(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=N(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=N(e,e.ins_h,e.window[e.strstart+1]);else n=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?1:2},$=(e,t)=>{let i,n,a;for(;;){if(e.lookahead<T){if(K(e),e.lookahead<T&&t===u)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=N(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-T&&(e.match_length=Z(e,i),e.match_length<=5&&(e.strategy===C||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,n=o(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=N(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,n&&(z(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(n=o(e,0,e.window[e.strstart-1]),n&&z(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=o(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?1:2};function W(e,t,i,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=n,this.func=a}const Y=[new W(0,0,0,0,((e,t)=>{let i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(K(e),0===e.lookahead&&t===u)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;const n=e.block_start+i;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,z(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-T&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(z(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(z(e,!1),e.strm.avail_out),1)})),new W(4,4,8,4,V),new W(4,5,16,8,V),new W(4,6,32,32,V),new W(4,4,16,16,$),new W(8,16,32,32,$),new W(8,16,128,128,$),new W(8,32,128,256,$),new W(32,128,258,1024,$),new W(32,258,258,4096,$)];function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),H(this.dyn_ltree),H(this.dyn_dtree),H(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),H(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),H(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const G=e=>{if(!e||!e.state)return F(e,v);e.total_in=e.total_out=0,e.data_type=I;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:E,e.adler=2===t.wrap?0:1,t.last_flush=u,n(t),f},J=e=>{const t=G(e);var i;return t===f&&((i=e.state).window_size=2*i.w_size,H(i.head),i.max_lazy_match=Y[i.level].max_lazy,i.good_match=Y[i.level].good_length,i.nice_match=Y[i.level].nice_length,i.max_chain_length=Y[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},q=(e,t,i,n,a,s)=>{if(!e)return v;let o=1;if(t===b&&(t=6),n<0?(o=0,n=-n):n>15&&(o=2,n-=16),a<1||a>9||i!==k||n<8||n>15||t<0||t>9||s<0||s>x)return F(e,v);8===n&&(n=9);const r=new j;return e.state=r,r.strm=e,r.wrap=o,r.gzhead=null,r.w_bits=n,r.w_size=1<<r.w_bits,r.w_mask=r.w_size-1,r.hash_bits=a+7,r.hash_size=1<<r.hash_bits,r.hash_mask=r.hash_size-1,r.hash_shift=~~((r.hash_bits+3-1)/3),r.window=new Uint8Array(2*r.w_size),r.head=new Uint16Array(r.hash_size),r.prev=new Uint16Array(r.w_size),r.lit_bufsize=1<<a+6,r.pending_buf_size=4*r.lit_bufsize,r.pending_buf=new Uint8Array(r.pending_buf_size),r.d_buf=1*r.lit_bufsize,r.l_buf=3*r.lit_bufsize,r.level=t,r.strategy=s,r.method=i,J(e)};e.exports.deflateInit=(e,t)=>q(e,t,k,15,8,D),e.exports.deflateInit2=q,e.exports.deflateReset=J,e.exports.deflateResetKeep=G,e.exports.deflateSetHeader=(e,t)=>e&&e.state?2!==e.state.wrap?v:(e.state.gzhead=t,f):v,e.exports.deflate=(e,t)=>{let i,n;if(!e||!e.state||t>g||t<0)return e?F(e,v):v;const s=e.state;if(!e.output||!e.input&&0!==e.avail_in||s.status===O&&t!==m)return F(e,0===e.avail_out?S:v);s.strm=e;const l=s.last_flush;if(s.last_flush=t,42===s.status)if(2===s.wrap)e.adler=0,L(s,31),L(s,139),L(s,8),s.gzhead?(L(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),L(s,255&s.gzhead.time),L(s,s.gzhead.time>>8&255),L(s,s.gzhead.time>>16&255),L(s,s.gzhead.time>>24&255),L(s,9===s.level?2:s.strategy>=A||s.level<2?4:0),L(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(L(s,255&s.gzhead.extra.length),L(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=d(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(L(s,0),L(s,0),L(s,0),L(s,0),L(s,0),L(s,9===s.level?2:s.strategy>=A||s.level<2?4:0),L(s,3),s.status=E);else{let t=k+(s.w_bits-8<<4)<<8,i=-1;i=s.strategy>=A||s.level<2?0:s.level<6?1:6===s.level?2:3,t|=i<<6,0!==s.strstart&&(t|=32),t+=31-t%31,s.status=E,Q(s,t),0!==s.strstart&&(Q(s,e.adler>>>16),Q(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(i=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),U(e),i=s.pending,s.pending!==s.pending_buf_size));)L(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),U(e),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,L(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){i=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),U(e),i=s.pending,s.pending===s.pending_buf_size)){n=1;break}n=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,L(s,n)}while(0!==n);s.gzhead.hcrc&&s.pending>i&&(e.adler=d(e.adler,s.pending_buf,s.pending-i,i)),0===n&&(s.status=M)}else s.status=M;if(s.status===M&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&U(e),s.pending+2<=s.pending_buf_size&&(L(s,255&e.adler),L(s,e.adler>>8&255),e.adler=0,s.status=E)):s.status=E),0!==s.pending){if(U(e),0===e.avail_out)return s.last_flush=-1,f}else if(0===e.avail_in&&P(t)<=P(l)&&t!==m)return F(e,S);if(s.status===O&&0!==e.avail_in)return F(e,S);if(0!==e.avail_in||0!==s.lookahead||t!==u&&s.status!==O){let i=s.strategy===A?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(K(e),0===e.lookahead)){if(t===u)return 1;break}if(e.match_length=0,i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?1:2})(s,t):s.strategy===y?((e,t)=>{let i,n,a,s;const r=e.window;for(;;){if(e.lookahead<=R){if(K(e),e.lookahead<=R&&t===u)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(a=e.strstart-1,n=r[a],n===r[++a]&&n===r[++a]&&n===r[++a])){s=e.strstart+R;do{}while(n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&n===r[++a]&&a<s);e.match_length=R-(s-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=o(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=o(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(z(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===m?(z(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(z(e,!1),0===e.strm.avail_out)?1:2})(s,t):Y[s.level].func(s,t);if(3!==i&&4!==i||(s.status=O),1===i||3===i)return 0===e.avail_out&&(s.last_flush=-1),f;if(2===i&&(t===c?r(s):t!==g&&(a(s,0,0,!1),t===_&&(H(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),U(e),0===e.avail_out))return s.last_flush=-1,f}return t!==m?f:s.wrap<=0?p:(2===s.wrap?(L(s,255&e.adler),L(s,e.adler>>8&255),L(s,e.adler>>16&255),L(s,e.adler>>24&255),L(s,255&e.total_in),L(s,e.total_in>>8&255),L(s,e.total_in>>16&255),L(s,e.total_in>>24&255)):(Q(s,e.adler>>>16),Q(s,65535&e.adler)),U(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?f:p)},e.exports.deflateEnd=e=>{if(!e||!e.state)return v;const t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&t!==M&&t!==E&&t!==O?F(e,v):(e.state=null,t===E?F(e,w):f)},e.exports.deflateSetDictionary=(e,t)=>{let i=t.length;if(!e||!e.state)return v;const n=e.state,a=n.wrap;if(2===a||1===a&&42!==n.status||n.lookahead)return v;if(1===a&&(e.adler=l(e.adler,t,i,0)),n.wrap=0,i>=n.w_size){0===a&&(H(n.head),n.strstart=0,n.block_start=0,n.insert=0);let e=new Uint8Array(n.w_size);e.set(t.subarray(i-n.w_size,i),0),t=e,i=n.w_size}const s=e.avail_in,o=e.next_in,r=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,K(n);n.lookahead>=3;){let e=n.strstart,t=n.lookahead-2;do{n.ins_h=N(n,n.ins_h,n.window[e+3-1]),n.prev[e&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=e,e++}while(--t);n.strstart=e,n.lookahead=2,K(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,e.next_in=o,e.input=r,e.avail_in=s,n.wrap=a,f},e.exports.deflateInfo="pako deflate (from Nodeca project)"},401:e=>{e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},264:e=>{e.exports=function(e,t){let i,n,a,s,o,r,l,d,h,u,c,_,m,g,f,p,v,w,S,b,C,A,y,x;const D=e.state;i=e.next_in,y=e.input,n=i+(e.avail_in-5),a=e.next_out,x=e.output,s=a-(t-e.avail_out),o=a+(e.avail_out-257),r=D.dmax,l=D.wsize,d=D.whave,h=D.wnext,u=D.window,c=D.hold,_=D.bits,m=D.lencode,g=D.distcode,f=(1<<D.lenbits)-1,p=(1<<D.distbits)-1;e:do{_<15&&(c+=y[i++]<<_,_+=8,c+=y[i++]<<_,_+=8),v=m[c&f];t:for(;;){if(w=v>>>24,c>>>=w,_-=w,w=v>>>16&255,0===w)x[a++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=m[(65535&v)+(c&(1<<w)-1)];continue t}if(32&w){D.mode=12;break e}e.msg="invalid literal/length code",D.mode=30;break e}S=65535&v,w&=15,w&&(_<w&&(c+=y[i++]<<_,_+=8),S+=c&(1<<w)-1,c>>>=w,_-=w),_<15&&(c+=y[i++]<<_,_+=8,c+=y[i++]<<_,_+=8),v=g[c&p];i:for(;;){if(w=v>>>24,c>>>=w,_-=w,w=v>>>16&255,!(16&w)){if(0==(64&w)){v=g[(65535&v)+(c&(1<<w)-1)];continue i}e.msg="invalid distance code",D.mode=30;break e}if(b=65535&v,w&=15,_<w&&(c+=y[i++]<<_,_+=8,_<w&&(c+=y[i++]<<_,_+=8)),b+=c&(1<<w)-1,b>r){e.msg="invalid distance too far back",D.mode=30;break e}if(c>>>=w,_-=w,w=a-s,b>w){if(w=b-w,w>d&&D.sane){e.msg="invalid distance too far back",D.mode=30;break e}if(C=0,A=u,0===h){if(C+=l-w,w<S){S-=w;do{x[a++]=u[C++]}while(--w);C=a-b,A=x}}else if(h<w){if(C+=l+h-w,w-=h,w<S){S-=w;do{x[a++]=u[C++]}while(--w);if(C=0,h<S){w=h,S-=w;do{x[a++]=u[C++]}while(--w);C=a-b,A=x}}}else if(C+=h-w,w<S){S-=w;do{x[a++]=u[C++]}while(--w);C=a-b,A=x}for(;S>2;)x[a++]=A[C++],x[a++]=A[C++],x[a++]=A[C++],S-=3;S&&(x[a++]=A[C++],S>1&&(x[a++]=A[C++]))}else{C=a-b;do{x[a++]=x[C++],x[a++]=x[C++],x[a++]=x[C++],S-=3}while(S>2);S&&(x[a++]=x[C++],S>1&&(x[a++]=x[C++]))}break}}break}}while(i<n&&a<o);S=_>>3,i-=S,_-=S<<3,c&=(1<<_)-1,e.next_in=i,e.next_out=a,e.avail_in=i<n?n-i+5:5-(i-n),e.avail_out=a<o?o-a+257:257-(a-o),D.hold=c,D.bits=_}},948:(e,t,i)=>{const n=i(69),a=i(869),s=i(264),o=i(241),{Z_FINISH:r,Z_BLOCK:l,Z_TREES:d,Z_OK:h,Z_STREAM_END:u,Z_NEED_DICT:c,Z_STREAM_ERROR:_,Z_DATA_ERROR:m,Z_MEM_ERROR:g,Z_BUF_ERROR:f,Z_DEFLATED:p}=i(619),v=12,w=30,S=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function b(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const C=e=>{if(!e||!e.state)return _;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,h},A=e=>{if(!e||!e.state)return _;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,C(e)},y=(e,t)=>{let i;if(!e||!e.state)return _;const n=e.state;return t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=i,n.wbits=t,A(e))},x=(e,t)=>{if(!e)return _;const i=new b;e.state=i,i.window=null;const n=y(e,t);return n!==h&&(e.state=null),n};let D,I,k=!0;const R=e=>{if(k){D=new Int32Array(512),I=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,D,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,I,0,e.work,{bits:5}),k=!1}e.lencode=D,e.lenbits=9,e.distcode=I,e.distbits=5},T=(e,t,i,n)=>{let a;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),n>=s.wsize?(s.window.set(t.subarray(i-s.wsize,i),0),s.wnext=0,s.whave=s.wsize):(a=s.wsize-s.wnext,a>n&&(a=n),s.window.set(t.subarray(i-n,i-n+a),s.wnext),(n-=a)?(s.window.set(t.subarray(i-n,i),0),s.wnext=n,s.whave=s.wsize):(s.wnext+=a,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=a))),0};e.exports.inflateReset=A,e.exports.inflateReset2=y,e.exports.inflateResetKeep=C,e.exports.inflateInit=e=>x(e,15),e.exports.inflateInit2=x,e.exports.inflate=(e,t)=>{let i,b,C,A,y,x,D,I,k,M,E,O,F,P,H,N,U,z,L,Q,B,Z,K=0;const V=new Uint8Array(4);let $,W;const Y=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return _;i=e.state,i.mode===v&&(i.mode=13),y=e.next_out,C=e.output,D=e.avail_out,A=e.next_in,b=e.input,x=e.avail_in,I=i.hold,k=i.bits,M=x,E=D,Z=h;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;k<16;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(2&i.wrap&&35615===I){i.check=0,V[0]=255&I,V[1]=I>>>8&255,i.check=a(i.check,V,2,0),I=0,k=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&I)<<8)+(I>>8))%31){e.msg="incorrect header check",i.mode=w;break}if((15&I)!==p){e.msg="unknown compression method",i.mode=w;break}if(I>>>=4,k-=4,B=8+(15&I),0===i.wbits)i.wbits=B;else if(B>i.wbits){e.msg="invalid window size",i.mode=w;break}i.dmax=1<<i.wbits,e.adler=i.check=1,i.mode=512&I?10:v,I=0,k=0;break;case 2:for(;k<16;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(i.flags=I,(255&i.flags)!==p){e.msg="unknown compression method",i.mode=w;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=w;break}i.head&&(i.head.text=I>>8&1),512&i.flags&&(V[0]=255&I,V[1]=I>>>8&255,i.check=a(i.check,V,2,0)),I=0,k=0,i.mode=3;case 3:for(;k<32;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.head&&(i.head.time=I),512&i.flags&&(V[0]=255&I,V[1]=I>>>8&255,V[2]=I>>>16&255,V[3]=I>>>24&255,i.check=a(i.check,V,4,0)),I=0,k=0,i.mode=4;case 4:for(;k<16;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.head&&(i.head.xflags=255&I,i.head.os=I>>8),512&i.flags&&(V[0]=255&I,V[1]=I>>>8&255,i.check=a(i.check,V,2,0)),I=0,k=0,i.mode=5;case 5:if(1024&i.flags){for(;k<16;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.length=I,i.head&&(i.head.extra_len=I),512&i.flags&&(V[0]=255&I,V[1]=I>>>8&255,i.check=a(i.check,V,2,0)),I=0,k=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(O=i.length,O>x&&(O=x),O&&(i.head&&(B=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(b.subarray(A,A+O),B)),512&i.flags&&(i.check=a(i.check,b,O,A)),x-=O,A+=O,i.length-=O),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===x)break e;O=0;do{B=b[A+O++],i.head&&B&&i.length<65536&&(i.head.name+=String.fromCharCode(B))}while(B&&O<x);if(512&i.flags&&(i.check=a(i.check,b,O,A)),x-=O,A+=O,B)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===x)break e;O=0;do{B=b[A+O++],i.head&&B&&i.length<65536&&(i.head.comment+=String.fromCharCode(B))}while(B&&O<x);if(512&i.flags&&(i.check=a(i.check,b,O,A)),x-=O,A+=O,B)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;k<16;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(I!==(65535&i.check)){e.msg="header crc mismatch",i.mode=w;break}I=0,k=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=v;break;case 10:for(;k<32;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}e.adler=i.check=S(I),I=0,k=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=y,e.avail_out=D,e.next_in=A,e.avail_in=x,i.hold=I,i.bits=k,c;e.adler=i.check=1,i.mode=v;case v:if(t===l||t===d)break e;case 13:if(i.last){I>>>=7&k,k-=7&k,i.mode=27;break}for(;k<3;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}switch(i.last=1&I,I>>>=1,k-=1,3&I){case 0:i.mode=14;break;case 1:if(R(i),i.mode=20,t===d){I>>>=2,k-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=w}I>>>=2,k-=2;break;case 14:for(I>>>=7&k,k-=7&k;k<32;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if((65535&I)!=(I>>>16^65535)){e.msg="invalid stored block lengths",i.mode=w;break}if(i.length=65535&I,I=0,k=0,i.mode=15,t===d)break e;case 15:i.mode=16;case 16:if(O=i.length,O){if(O>x&&(O=x),O>D&&(O=D),0===O)break e;C.set(b.subarray(A,A+O),y),x-=O,A+=O,D-=O,y+=O,i.length-=O;break}i.mode=v;break;case 17:for(;k<14;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(i.nlen=257+(31&I),I>>>=5,k-=5,i.ndist=1+(31&I),I>>>=5,k-=5,i.ncode=4+(15&I),I>>>=4,k-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=w;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;k<3;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.lens[Y[i.have++]]=7&I,I>>>=3,k-=3}for(;i.have<19;)i.lens[Y[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,$={bits:i.lenbits},Z=o(0,i.lens,0,19,i.lencode,0,i.work,$),i.lenbits=$.bits,Z){e.msg="invalid code lengths set",i.mode=w;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;K=i.lencode[I&(1<<i.lenbits)-1],H=K>>>24,N=K>>>16&255,U=65535&K,!(H<=k);){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(U<16)I>>>=H,k-=H,i.lens[i.have++]=U;else{if(16===U){for(W=H+2;k<W;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(I>>>=H,k-=H,0===i.have){e.msg="invalid bit length repeat",i.mode=w;break}B=i.lens[i.have-1],O=3+(3&I),I>>>=2,k-=2}else if(17===U){for(W=H+3;k<W;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}I>>>=H,k-=H,B=0,O=3+(7&I),I>>>=3,k-=3}else{for(W=H+7;k<W;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}I>>>=H,k-=H,B=0,O=11+(127&I),I>>>=7,k-=7}if(i.have+O>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=w;break}for(;O--;)i.lens[i.have++]=B}}if(i.mode===w)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=w;break}if(i.lenbits=9,$={bits:i.lenbits},Z=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,$),i.lenbits=$.bits,Z){e.msg="invalid literal/lengths set",i.mode=w;break}if(i.distbits=6,i.distcode=i.distdyn,$={bits:i.distbits},Z=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,$),i.distbits=$.bits,Z){e.msg="invalid distances set",i.mode=w;break}if(i.mode=20,t===d)break e;case 20:i.mode=21;case 21:if(x>=6&&D>=258){e.next_out=y,e.avail_out=D,e.next_in=A,e.avail_in=x,i.hold=I,i.bits=k,s(e,E),y=e.next_out,C=e.output,D=e.avail_out,A=e.next_in,b=e.input,x=e.avail_in,I=i.hold,k=i.bits,i.mode===v&&(i.back=-1);break}for(i.back=0;K=i.lencode[I&(1<<i.lenbits)-1],H=K>>>24,N=K>>>16&255,U=65535&K,!(H<=k);){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(N&&0==(240&N)){for(z=H,L=N,Q=U;K=i.lencode[Q+((I&(1<<z+L)-1)>>z)],H=K>>>24,N=K>>>16&255,U=65535&K,!(z+H<=k);){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}I>>>=z,k-=z,i.back+=z}if(I>>>=H,k-=H,i.back+=H,i.length=U,0===N){i.mode=26;break}if(32&N){i.back=-1,i.mode=v;break}if(64&N){e.msg="invalid literal/length code",i.mode=w;break}i.extra=15&N,i.mode=22;case 22:if(i.extra){for(W=i.extra;k<W;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.length+=I&(1<<i.extra)-1,I>>>=i.extra,k-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;K=i.distcode[I&(1<<i.distbits)-1],H=K>>>24,N=K>>>16&255,U=65535&K,!(H<=k);){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(0==(240&N)){for(z=H,L=N,Q=U;K=i.distcode[Q+((I&(1<<z+L)-1)>>z)],H=K>>>24,N=K>>>16&255,U=65535&K,!(z+H<=k);){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}I>>>=z,k-=z,i.back+=z}if(I>>>=H,k-=H,i.back+=H,64&N){e.msg="invalid distance code",i.mode=w;break}i.offset=U,i.extra=15&N,i.mode=24;case 24:if(i.extra){for(W=i.extra;k<W;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}i.offset+=I&(1<<i.extra)-1,I>>>=i.extra,k-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=w;break}i.mode=25;case 25:if(0===D)break e;if(O=E-D,i.offset>O){if(O=i.offset-O,O>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=w;break}O>i.wnext?(O-=i.wnext,F=i.wsize-O):F=i.wnext-O,O>i.length&&(O=i.length),P=i.window}else P=C,F=y-i.offset,O=i.length;O>D&&(O=D),D-=O,i.length-=O;do{C[y++]=P[F++]}while(--O);0===i.length&&(i.mode=21);break;case 26:if(0===D)break e;C[y++]=i.length,D--,i.mode=21;break;case 27:if(i.wrap){for(;k<32;){if(0===x)break e;x--,I|=b[A++]<<k,k+=8}if(E-=D,e.total_out+=E,i.total+=E,E&&(e.adler=i.check=i.flags?a(i.check,C,E,y-E):n(i.check,C,E,y-E)),E=D,(i.flags?I:S(I))!==i.check){e.msg="incorrect data check",i.mode=w;break}I=0,k=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;k<32;){if(0===x)break e;x--,I+=b[A++]<<k,k+=8}if(I!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=w;break}I=0,k=0}i.mode=29;case 29:Z=u;break e;case w:Z=m;break e;case 31:return g;case 32:default:return _}return e.next_out=y,e.avail_out=D,e.next_in=A,e.avail_in=x,i.hold=I,i.bits=k,(i.wsize||E!==e.avail_out&&i.mode<w&&(i.mode<27||t!==r))&&T(e,e.output,e.next_out,E-e.avail_out)?(i.mode=31,g):(M-=e.avail_in,E-=e.avail_out,e.total_in+=M,e.total_out+=E,i.total+=E,i.wrap&&E&&(e.adler=i.check=i.flags?a(i.check,C,E,e.next_out-E):n(i.check,C,E,e.next_out-E)),e.data_type=i.bits+(i.last?64:0)+(i.mode===v?128:0)+(20===i.mode||15===i.mode?256:0),(0===M&&0===E||t===r)&&Z===h&&(Z=f),Z)},e.exports.inflateEnd=e=>{if(!e||!e.state)return _;let t=e.state;return t.window&&(t.window=null),e.state=null,h},e.exports.inflateGetHeader=(e,t)=>{if(!e||!e.state)return _;const i=e.state;return 0==(2&i.wrap)?_:(i.head=t,t.done=!1,h)},e.exports.inflateSetDictionary=(e,t)=>{const i=t.length;let a,s,o;return e&&e.state?(a=e.state,0!==a.wrap&&11!==a.mode?_:11===a.mode&&(s=1,s=n(s,t,i,0),s!==a.check)?m:(o=T(e,t,i,i),o?(a.mode=31,g):(a.havedict=1,h))):_},e.exports.inflateInfo="pako inflate (from Nodeca project)"},241:e=>{const t=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),i=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),n=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),a=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);e.exports=(e,s,o,r,l,d,h,u)=>{const c=u.bits;let _,m,g,f,p,v,w=0,S=0,b=0,C=0,A=0,y=0,x=0,D=0,I=0,k=0,R=null,T=0;const M=new Uint16Array(16),E=new Uint16Array(16);let O,F,P,H=null,N=0;for(w=0;w<=15;w++)M[w]=0;for(S=0;S<r;S++)M[s[o+S]]++;for(A=c,C=15;C>=1&&0===M[C];C--);if(A>C&&(A=C),0===C)return l[d++]=20971520,l[d++]=20971520,u.bits=1,0;for(b=1;b<C&&0===M[b];b++);for(A<b&&(A=b),D=1,w=1;w<=15;w++)if(D<<=1,D-=M[w],D<0)return-1;if(D>0&&(0===e||1!==C))return-1;for(E[1]=0,w=1;w<15;w++)E[w+1]=E[w]+M[w];for(S=0;S<r;S++)0!==s[o+S]&&(h[E[s[o+S]]++]=S);if(0===e?(R=H=h,v=19):1===e?(R=t,T-=257,H=i,N-=257,v=256):(R=n,H=a,v=-1),k=0,S=0,w=b,p=d,y=A,x=0,g=-1,I=1<<A,f=I-1,1===e&&I>852||2===e&&I>592)return 1;for(;;){O=w-x,h[S]<v?(F=0,P=h[S]):h[S]>v?(F=H[N+h[S]],P=R[T+h[S]]):(F=96,P=0),_=1<<w-x,m=1<<y,b=m;do{m-=_,l[p+(k>>x)+m]=O<<24|F<<16|P|0}while(0!==m);for(_=1<<w-1;k&_;)_>>=1;if(0!==_?(k&=_-1,k+=_):k=0,S++,0==--M[w]){if(w===C)break;w=s[o+h[S]]}if(w>A&&(k&f)!==g){for(0===x&&(x=A),p+=b,y=w-x,D=1<<y;y+x<C&&(D-=M[y+x],!(D<=0));)y++,D<<=1;if(I+=1<<y,1===e&&I>852||2===e&&I>592)return 1;g=k&f,l[g]=A<<24|y<<16|p-d|0}}return 0!==k&&(l[p+k]=w-x<<24|64<<16|0),u.bits=A,0}},898:e=>{e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},342:e=>{function t(e){let t=e.length;for(;--t>=0;)e[t]=0}const i=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),n=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),a=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),s=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),o=new Array(576);t(o);const r=new Array(60);t(r);const l=new Array(512);t(l);const d=new Array(256);t(d);const h=new Array(29);t(h);const u=new Array(30);function c(e,t,i,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let _,m,g;function f(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}t(u);const p=e=>e<256?l[e]:l[256+(e>>>7)],v=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},w=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,v(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},S=(e,t,i)=>{w(e,i[2*t],i[2*t+1])},b=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},C=(e,t,i)=>{const n=new Array(16);let a,s,o=0;for(a=1;a<=15;a++)n[a]=o=o+i[a-1]<<1;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=b(n[t]++,t))}},A=e=>{let t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},y=e=>{e.bi_valid>8?v(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},x=(e,t,i,n)=>{const a=2*t,s=2*i;return e[a]<e[s]||e[a]===e[s]&&n[t]<=n[i]},D=(e,t,i)=>{const n=e.heap[i];let a=i<<1;for(;a<=e.heap_len&&(a<e.heap_len&&x(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!x(t,n,e.heap[a],e.depth));)e.heap[i]=e.heap[a],i=a,a<<=1;e.heap[i]=n},I=(e,t,a)=>{let s,o,r,l,c=0;if(0!==e.last_lit)do{s=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],o=e.pending_buf[e.l_buf+c],c++,0===s?S(e,o,t):(r=d[o],S(e,r+256+1,t),l=i[r],0!==l&&(o-=h[r],w(e,o,l)),s--,r=p(s),S(e,r,a),l=n[r],0!==l&&(s-=u[r],w(e,s,l)))}while(c<e.last_lit);S(e,256,t)},k=(e,t)=>{const i=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,r,l,d=-1;for(e.heap_len=0,e.heap_max=573,o=0;o<s;o++)0!==i[2*o]?(e.heap[++e.heap_len]=d=o,e.depth[o]=0):i[2*o+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=d<2?++d:0,i[2*l]=1,e.depth[l]=0,e.opt_len--,a&&(e.static_len-=n[2*l+1]);for(t.max_code=d,o=e.heap_len>>1;o>=1;o--)D(e,i,o);l=s;do{o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,i,1),r=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=r,i[2*l]=i[2*o]+i[2*r],e.depth[l]=(e.depth[o]>=e.depth[r]?e.depth[o]:e.depth[r])+1,i[2*o+1]=i[2*r+1]=l,e.heap[1]=l++,D(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,r=t.stat_desc.extra_base,l=t.stat_desc.max_length;let d,h,u,c,_,m,g=0;for(c=0;c<=15;c++)e.bl_count[c]=0;for(i[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)h=e.heap[d],c=i[2*i[2*h+1]+1]+1,c>l&&(c=l,g++),i[2*h+1]=c,h>n||(e.bl_count[c]++,_=0,h>=r&&(_=o[h-r]),m=i[2*h],e.opt_len+=m*(c+_),s&&(e.static_len+=m*(a[2*h+1]+_)));if(0!==g){do{for(c=l-1;0===e.bl_count[c];)c--;e.bl_count[c]--,e.bl_count[c+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(c=l;0!==c;c--)for(h=e.bl_count[c];0!==h;)u=e.heap[--d],u>n||(i[2*u+1]!==c&&(e.opt_len+=(c-i[2*u+1])*i[2*u],i[2*u+1]=c),h--)}})(e,t),C(i,d,e.bl_count)},R=(e,t,i)=>{let n,a,s=-1,o=t[1],r=0,l=7,d=4;for(0===o&&(l=138,d=3),t[2*(i+1)+1]=65535,n=0;n<=i;n++)a=o,o=t[2*(n+1)+1],++r<l&&a===o||(r<d?e.bl_tree[2*a]+=r:0!==a?(a!==s&&e.bl_tree[2*a]++,e.bl_tree[32]++):r<=10?e.bl_tree[34]++:e.bl_tree[36]++,r=0,s=a,0===o?(l=138,d=3):a===o?(l=6,d=3):(l=7,d=4))},T=(e,t,i)=>{let n,a,s=-1,o=t[1],r=0,l=7,d=4;for(0===o&&(l=138,d=3),n=0;n<=i;n++)if(a=o,o=t[2*(n+1)+1],!(++r<l&&a===o)){if(r<d)do{S(e,a,e.bl_tree)}while(0!=--r);else 0!==a?(a!==s&&(S(e,a,e.bl_tree),r--),S(e,16,e.bl_tree),w(e,r-3,2)):r<=10?(S(e,17,e.bl_tree),w(e,r-3,3)):(S(e,18,e.bl_tree),w(e,r-11,7));r=0,s=a,0===o?(l=138,d=3):a===o?(l=6,d=3):(l=7,d=4)}};let M=!1;const E=(e,t,i,n)=>{w(e,0+(n?1:0),3),((e,t,i,n)=>{y(e),v(e,i),v(e,~i),e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i})(e,t,i)};e.exports._tr_init=e=>{M||((()=>{let e,t,s,f,p;const v=new Array(16);for(s=0,f=0;f<28;f++)for(h[f]=s,e=0;e<1<<i[f];e++)d[s++]=f;for(d[s-1]=f,p=0,f=0;f<16;f++)for(u[f]=p,e=0;e<1<<n[f];e++)l[p++]=f;for(p>>=7;f<30;f++)for(u[f]=p<<7,e=0;e<1<<n[f]-7;e++)l[256+p++]=f;for(t=0;t<=15;t++)v[t]=0;for(e=0;e<=143;)o[2*e+1]=8,e++,v[8]++;for(;e<=255;)o[2*e+1]=9,e++,v[9]++;for(;e<=279;)o[2*e+1]=7,e++,v[7]++;for(;e<=287;)o[2*e+1]=8,e++,v[8]++;for(C(o,287,v),e=0;e<30;e++)r[2*e+1]=5,r[2*e]=b(e,5);_=new c(o,i,257,286,15),m=new c(r,n,0,30,15),g=new c(new Array(0),a,0,19,7)})(),M=!0),e.l_desc=new f(e.dyn_ltree,_),e.d_desc=new f(e.dyn_dtree,m),e.bl_desc=new f(e.bl_tree,g),e.bi_buf=0,e.bi_valid=0,A(e)},e.exports._tr_stored_block=E,e.exports._tr_flush_block=(e,t,i,n)=>{let a,l,d=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),k(e,e.l_desc),k(e,e.d_desc),d=(e=>{let t;for(R(e,e.dyn_ltree,e.l_desc.max_code),R(e,e.dyn_dtree,e.d_desc.max_code),k(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*s[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),a=e.opt_len+3+7>>>3,l=e.static_len+3+7>>>3,l<=a&&(a=l)):a=l=i+5,i+4<=a&&-1!==t?E(e,t,i,n):4===e.strategy||l===a?(w(e,2+(n?1:0),3),I(e,o,r)):(w(e,4+(n?1:0),3),((e,t,i,n)=>{let a;for(w(e,t-257,5),w(e,i-1,5),w(e,n-4,4),a=0;a<n;a++)w(e,e.bl_tree[2*s[a]+1],3);T(e,e.dyn_ltree,t-1),T(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,d+1),I(e,e.dyn_ltree,e.dyn_dtree)),A(e),n&&y(e)},e.exports._tr_tally=(e,t,i)=>(e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(d[i]+256+1)]++,e.dyn_dtree[2*p(t)]++),e.last_lit===e.lit_bufsize-1),e.exports._tr_align=e=>{w(e,2,3),S(e,256,o),(e=>{16===e.bi_valid?(v(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}},292:e=>{e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},631:(e,t,i)=>{i.r(t),i.d(t,{AudioAPIData:()=>u,AvailableUserDataSubscriptionComponents:()=>K,Axes:()=>m,AxisConfiguration:()=>p,Communicator:()=>j,ConnectionStates:()=>$,Constants:()=>_,Handedness:()=>g,HiFiAudioAPIData:()=>u,HiFiAxes:()=>m,HiFiAxisConfiguration:()=>p,HiFiCommunicator:()=>j,HiFiConnectionStates:()=>$,HiFiConstants:()=>_,HiFiHandedness:()=>g,HiFiLogLevel:()=>f.D,HiFiLogger:()=>f.M,HiFiUserDataStreamingScopes:()=>W,HiFiUtilities:()=>a.H,LogLevel:()=>f.D,Logger:()=>f.M,OrientationEuler3D:()=>l,OrientationQuat3D:()=>o,Point3D:()=>s,ReceivedAudioAPIData:()=>c,ReceivedHiFiAudioAPIData:()=>c,UserDataStreamingScopes:()=>W,UserDataSubscription:()=>V,Utilities:()=>a.H,apiVersion:()=>G,eulerFromQuaternion:()=>h,eulerToQuaternion:()=>d,getBestAudioConstraints:()=>J,hiFiAPIVersion:()=>G,preciseInterval:()=>q});var n,a=i(24);class s{constructor({x:e=0,y:t=0,z:i=0}={}){this.x=e,this.y=t,this.z=i}}class o{constructor({w:e=1,x:t=0,y:i=0,z:n=0}={}){this.w=a.H.clampNonan(e,-1,1,1),this.x=a.H.clampNonan(t,-1,1,0),this.y=a.H.clampNonan(i,-1,1,0),this.z=a.H.clampNonan(n,-1,1,0)}}function r(e){return isNaN(e)||e===1/0?0:e===-1/0?-0:e%360}class l{constructor({pitchDegrees:e=0,yawDegrees:t=0,rollDegrees:i=0}={}){this.pitchDegrees=r(e),this.yawDegrees=r(t),this.rollDegrees=r(i)}}function d(e,t){const i=.5*Math.PI/180;let a=Math.cos(e.pitchDegrees*i),s=Math.cos(e.yawDegrees*i),r=Math.cos(e.rollDegrees*i),l=Math.sin(e.pitchDegrees*i),d=Math.sin(e.yawDegrees*i),h=Math.sin(e.rollDegrees*i),u=l*s*r,c=a*d*r,_=a*s*h,m=a*s*r,g=a*d*h,f=l*s*h,p=l*d*r,v=l*d*h;switch(t){case n.PitchYawRoll:return new o({x:u+g,y:c-f,z:_+p,w:m-v});case n.YawPitchRoll:return new o({x:u+g,y:c-f,z:_-p,w:m+v});case n.RollPitchYaw:return new o({x:u-g,y:c+f,z:_+p,w:m-v});case n.RollYawPitch:return new o({x:u-g,y:c+f,z:_-p,w:m+v});case n.YawRollPitch:return new o({x:u+g,y:c+f,z:_-p,w:m-v});case n.PitchRollYaw:return new o({x:u-g,y:c-f,z:_+p,w:m+v})}}function h(e,t){let i=e.x*e.x,s=e.y*e.y,o=e.z*e.z,r=e.w*e.x,d=e.w*e.y,h=e.w*e.z,u=e.x*e.y,c=e.y*e.z,_=e.z*e.x,m=1-2*(s+o),g=2*(u+h),f=2*(_-d),p=2*(u-h),v=1-2*(i+o),w=2*(c+r),S=2*(_+d),b=2*(c-r),C=1-2*(i+s),A=0,y=0,x=0;const D=.9999999;switch(t){case n.PitchYawRoll:y=Math.asin(a.H.clampNormalized(S)),Math.abs(S)<D?(A=Math.atan2(-b,C),x=Math.atan2(-p,m)):A=Math.atan2(w,v);break;case n.YawPitchRoll:A=Math.asin(a.H.clampNormalized(-b)),Math.abs(b)<D?(y=Math.atan2(S,C),x=Math.atan2(g,v)):y=Math.atan2(-f,m);break;case n.RollPitchYaw:A=Math.asin(a.H.clampNormalized(w)),Math.abs(w)<D?(y=Math.atan2(-f,C),x=Math.atan2(-p,v)):x=Math.atan2(g,m);break;case n.RollYawPitch:y=Math.asin(a.H.clampNormalized(-f)),Math.abs(f)<D?(A=Math.atan2(w,C),x=Math.atan2(g,m)):x=Math.atan2(-p,v);break;case n.YawRollPitch:x=Math.asin(a.H.clampNormalized(g)),Math.abs(g)<D?(A=Math.atan2(-b,v),y=Math.atan2(-f,m)):y=Math.atan2(S,C);break;case n.PitchRollYaw:x=Math.asin(a.H.clampNormalized(-p)),Math.abs(p)<D?(A=Math.atan2(w,v),y=Math.atan2(S,m)):y=Math.atan2(-b,C)}const I=180/Math.PI;return new l({pitchDegrees:I*A,yawDegrees:I*y,rollDegrees:I*x})}!function(e){e.PitchYawRoll="PitchYawRoll",e.YawPitchRoll="YawPitchRoll",e.RollPitchYaw="RollPitchYaw",e.RollYawPitch="RollYawPitch",e.YawRollPitch="YawRollPitch",e.PitchRollYaw="PitchRollYaw"}(n||(n={}));class u{constructor({position:e=null,orientationQuat:t=null,orientationEuler:i=null,volumeThreshold:n=null,hiFiGain:a=null,userAttenuation:s=null,userRolloff:o=null}={}){this.position=e,this.orientationQuat=t,this.orientationEuler=i,this.volumeThreshold=n,this.hiFiGain=a,this.userAttenuation=s,this.userRolloff=o}}class c extends u{constructor(e={}){super(e),this.providedUserID=e.providedUserID,this.hashedVisitID=e.hashedVisitID,this.volumeDecibels=e.volumeDecibels,this.isStereo=e.isStereo}}class _{constructor(){}}_.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS=10,_.DEFAULT_TRANSMIT_RATE_LIMIT_TIMEOUT_MS=50,_.DEFAULT_PROD_HIGH_FIDELITY_ENDPOINT="api.highfidelity.com",_.DEFAULT_PROD_HIGH_FIDELITY_PORT=443;var m,g,f=i(649);!function(e){e.PositiveX="Positive X",e.NegativeX="Negative X",e.PositiveY="Positive Y",e.NegativeY="Negative Y",e.PositiveZ="Positive Z",e.NegativeZ="Negative Z"}(m||(m={})),function(e){e.RightHand="Right Hand",e.LeftHand="Left Hand"}(g||(g={}));class p{constructor({rightAxis:e,leftAxis:t,intoScreenAxis:i,outOfScreenAxis:n,upAxis:a,downAxis:s,handedness:o,eulerOrder:r}){Object.assign(this,{rightAxis:e,leftAxis:t,intoScreenAxis:i,outOfScreenAxis:n,upAxis:a,downAxis:s,handedness:o,eulerOrder:r})}}let v=new p({rightAxis:m.PositiveX,leftAxis:m.NegativeX,intoScreenAxis:m.PositiveY,outOfScreenAxis:m.NegativeY,upAxis:m.PositiveZ,downAxis:m.NegativeZ,handedness:g.RightHand,eulerOrder:n.YawPitchRoll});class w{static verify(e){let t=!0;return e.rightAxis===m.PositiveX&&e.leftAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.leftAxis===m.PositiveX&&e.rightAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.rightAxis===m.PositiveY&&e.leftAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.leftAxis===m.PositiveY&&e.rightAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.rightAxis===m.PositiveZ&&e.leftAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.leftAxis===m.PositiveZ&&e.rightAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nRight Axis is ${e.rightAxis}, and Left Axis is ${e.leftAxis}!`),t=!1),e.intoScreenAxis===m.PositiveX&&e.outOfScreenAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.outOfScreenAxis===m.PositiveX&&e.intoScreenAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.intoScreenAxis===m.PositiveY&&e.outOfScreenAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.outOfScreenAxis===m.PositiveY&&e.intoScreenAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.intoScreenAxis===m.PositiveZ&&e.outOfScreenAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.outOfScreenAxis===m.PositiveZ&&e.intoScreenAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nIntoScreen Axis is ${e.intoScreenAxis}, and OutOfScreen Axis is ${e.outOfScreenAxis}!`),t=!1),e.upAxis===m.PositiveX&&e.downAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.downAxis===m.PositiveX&&e.upAxis!==m.NegativeX&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.upAxis===m.PositiveY&&e.downAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.downAxis===m.PositiveY&&e.upAxis!==m.NegativeY&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.upAxis===m.PositiveZ&&e.downAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.downAxis===m.PositiveZ&&e.upAxis!==m.NegativeZ&&(f.M.error(`Invalid axis configuration!\nUp Axis is ${e.upAxis}, and Down Axis is ${e.downAxis}!`),t=!1),e.handedness!==g.RightHand&&e.handedness!==g.LeftHand&&(f.M.error(`Invalid axis configuration!\nHandedness is ${e.handedness}!`),t=!1),t}static translatePoint3DToMixerSpace(e,t){let i=new s;return i=t,i}static translatePoint3DFromMixerSpace(e,t){let i=new s;return i=t,i}static translateOrientationQuat3DToMixerSpace(e,t){let i=new o;return i=t,i}static translateOrientationQuat3DFromMixerSpace(e,t){let i=new o;return i=t,i}}var S=!0;class b{static createUUID(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}static log(e,t){if(void 0!==t&&(e=t+": "+e),S&&console.log(e),"undefined"!=typeof document&&S)try{document.dispatchEvent(new CustomEvent("logger",{detail:e}))}catch(t){console.log(e),console.log("Additionally, an error was encountered trying to log that."),console.log(t)}}static err(e,t){void 0!==t&&(e=t+": "+e),console.log("%c %s","color: #FB0A1C",e),"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("errlogger",{detail:e}))}static safelyPrintable(e){try{return JSON.stringify(e)}catch(t){return e}}static getElementCSSSize(e){if(getComputedStyle){var t=getComputedStyle(e);return{width:parseInt(t.getPropertyValue("width"),10),height:parseInt(t.getPropertyValue("height"),10)}}}static setDebug(e){S=e}}class C{constructor(e){b.log("constructor","RaviStreamController"),this._commandController=e,this._audioStream=null,this._videoStream=null,this._onVideoStreamStateChanged=function(e){b.log("onvideostreamstatechanged "+e,"RaviStreamController")},this._onInputAudioChanged=null,this._onInputVideoChanged=null}getVideoStream(){return this._videoStream}_setVideoStream(e){this._videoStream=e,this._videoContainer&&(this._videoContainer.srcObject=this._videoStream)}setVideoContainer(e,t){this._videoContainer=e,this._videoStream&&(this._videoContainer.srcObject=this._videoStream),this.setVideoStateChangeHandler(t)}setVideoStateChangeHandler(e){e&&(this._onVideoStreamStateChanged=e)}showVideoDashboard(e){this._commandController.queueCommand("video.showDashboard",{enabled:e},null)}showVideoCursor(e){this._commandController.queueCommand("video.showCursor",{enabled:e},null)}getAudioStream(){return this._audioStream}_setAudioStream(e){this._audioStream=e,this._audioContainer&&(this._audioContainer.srcObject=this._audioStream)}setAudioContainer(e){this._audioContainer=e,this._audioStream&&(this._audioContainer.srcObject=this._audioStream)}setInputAudio(e,t=!1){this._inputAudioStream=e,this._isStereo=t,this._onInputAudioChanged&&this._onInputAudioChanged(e)}setInputAudioChangeHandler(e){e&&(this._onInputAudioChanged=e)}setInputVideo(e){this._inputVideoStream=e,this._onInputVideoChanged&&this._onInputVideoChanged(e)}setInputVideoChangeHandler(e){e&&(this._onInputVideoChanged=e)}isStereoInput(){return this._isStereo}_stop(){b.log("stopping streams","RaviStreamController"),this._videoContainer&&this._videoContainer.srcObject&&(this._videoContainer.srcObject.getTracks().forEach((e=>e.stop())),this._videoContainer.srcObject=null,this._onVideoStreamStateChanged("over")),this._audioStream&&(this._audioStream.getTracks().forEach((e=>e.stop())),this._audioStream=null)}}const A="_BINARY";var y;!function(e){e[e.ControlLeft=0]="ControlLeft",e[e.AltLeft=1]="AltLeft",e[e.OSLeft=2]="OSLeft",e[e.Space=3]="Space",e[e.OSRight=4]="OSRight",e[e.AltRight=5]="AltRight",e[e.ControlRight=6]="ControlRight",e[e.ShiftLeft=7]="ShiftLeft",e[e.ShiftRight=8]="ShiftRight",e[e.Comma=9]="Comma",e[e.Period=10]="Period",e[e.Slash=11]="Slash",e[e.CapsLock=12]="CapsLock",e[e.Enter=13]="Enter",e[e.Semicolon=14]="Semicolon",e[e.Quote=15]="Quote",e[e.Tab=16]="Tab",e[e.BracketLeft=17]="BracketLeft",e[e.BracketRight=18]="BracketRight",e[e.Backslash=19]="Backslash",e[e.Backquote=20]="Backquote",e[e.Minus=21]="Minus",e[e.Equal=22]="Equal",e[e.Digit0=23]="Digit0",e[e.Digit1=24]="Digit1",e[e.Digit2=25]="Digit2",e[e.Digit3=26]="Digit3",e[e.Digit4=27]="Digit4",e[e.Digit5=28]="Digit5",e[e.Digit6=29]="Digit6",e[e.Digit7=30]="Digit7",e[e.Digit8=31]="Digit8",e[e.Digit9=32]="Digit9",e[e.Backspace=33]="Backspace",e[e.Escape=34]="Escape",e[e.ArrowLeft=35]="ArrowLeft",e[e.ArrowRight=36]="ArrowRight",e[e.ArrowDown=37]="ArrowDown",e[e.ArrowUp=38]="ArrowUp",e[e.PageDown=39]="PageDown",e[e.PageUp=40]="PageUp",e[e.End=41]="End",e[e.Home=42]="Home",e[e.Delete=43]="Delete",e[e.Insert=44]="Insert",e[e.Numpad0=45]="Numpad0",e[e.Numpad1=46]="Numpad1",e[e.Numpad2=47]="Numpad2",e[e.Numpad3=48]="Numpad3",e[e.Numpad4=49]="Numpad4",e[e.Numpad5=50]="Numpad5",e[e.Numpad6=51]="Numpad6",e[e.Numpad7=52]="Numpad7",e[e.Numpad8=53]="Numpad8",e[e.Numpad9=54]="Numpad9",e[e.NumpadDecimal=55]="NumpadDecimal",e[e.NumpadEnter=56]="NumpadEnter",e[e.NumpadAdd=57]="NumpadAdd",e[e.NumpadSubtract=58]="NumpadSubtract",e[e.NumLock=59]="NumLock",e[e.NumpadEqual=60]="NumpadEqual",e[e.NumpadMultiply=61]="NumpadMultiply",e[e.NumpadDivide=62]="NumpadDivide",e[e.KeyA=63]="KeyA",e[e.KeyB=64]="KeyB",e[e.KeyC=65]="KeyC",e[e.KeyD=66]="KeyD",e[e.KeyE=67]="KeyE",e[e.KeyF=68]="KeyF",e[e.KeyG=69]="KeyG",e[e.KeyH=70]="KeyH",e[e.KeyI=71]="KeyI",e[e.KeyJ=72]="KeyJ",e[e.KeyK=73]="KeyK",e[e.KeyL=74]="KeyL",e[e.KeyM=75]="KeyM",e[e.KeyN=76]="KeyN",e[e.KeyO=77]="KeyO",e[e.KeyP=78]="KeyP",e[e.KeyQ=79]="KeyQ",e[e.KeyR=80]="KeyR",e[e.KeyS=81]="KeyS",e[e.KeyT=82]="KeyT",e[e.KeyU=83]="KeyU",e[e.KeyV=84]="KeyV",e[e.KeyW=85]="KeyW",e[e.KeyX=86]="KeyX",e[e.KeyY=87]="KeyY",e[e.KeyZ=88]="KeyZ"}(y||(y={}));class x{constructor(){b.log("constructor","RaviCommandController"),this._commandQueueMap=new Map,this._numQueuedCommands=0,this._commandQueueInterval=1e3,this._commandPumpTimer=null,this._inputTarget,this._keyboardTarget,this._mouseStateBuffer=new ArrayBuffer(32),this._mouseStateUint8=new Uint8Array(this._mouseStateBuffer),this._mouseStateUint8[0]=77,this._mouseStateFloat=new Float32Array(this._mouseStateBuffer,4),this._mouseStateFloat[0]=-1,this._mouseStateFloat[1]=-1,this._mouseStateFloat[2]=-1,this._mouseStateFloat[3]=-1,this._keyboardStateBuffer=new ArrayBuffer(13),this._keyboardState=new Uint8Array(this._keyboardStateBuffer),this._keyboardState[0]=75}setCommandQueueInterval(e){this._commandQueueInterval=e,this._commandPumpTimer&&(this.stopMonitoringQueues(),this.monitorQueues())}queueCommand(e,t,i){var n=this._commandQueueMap.get(e);n||(n={toSend:[],listener:[]},this._commandQueueMap.set(e,n));var a=null;i&&(a=new I(i,!1,!0)),n.toSend.push(new D(e,t,a)),this._numQueuedCommands++,b.log("Added command "+e,"RaviCommandController")}queueBinaryCommand(e){let t=A;var i=this._commandQueueMap.get(t);i||(i={toSend:[],listener:[]},this._commandQueueMap.set(t,i)),i.toSend.push(new D(e,null,null)),this._numQueuedCommands++,b.log("Added binary command","RaviCommandController")}addMessageHandler(e,t,i){var n=this._commandQueueMap.get(e);n||(n={toSend:[],listener:[]},this._commandQueueMap.set(e,n));var a=new I(t,i,!1);n.listener.push(a)}addBinaryHandler(e,t){this.addMessageHandler(A,e,t)}sendInput(e){this._inputDataChannel&&"open"===this._inputDataChannel.readyState&&this._inputDataChannel.send(e)}monitorQueues(){b.log("Begin monitoring for queued commands","RaviCommandController"),this._commandPumpTimer=setInterval(this._processSendingQueuedCommands.bind(this),this._commandQueueInterval)}stopMonitoringQueues(){b.log("Stop monitoring for queued commands","RaviCommandController"),clearInterval(this._commandPumpTimer),this._commandPumpTimer=null}_processSendingQueuedCommands(){this._numQueuedCommands<=0||this._commandQueueMap.forEach(function(e,t,i){if(e.toSend.length){var n=e.toSend.shift();n._handler&&e.listener.push(n._handler),this._sendCommandInstance(n)?this._numQueuedCommands--:b.log("Send failed. CommandDataChannel may have been disconnected. Will not retry.","RaviCommandController")}}.bind(this))}_serializeJsonCommandMessageToSend(e,t){return JSON.stringify({c:e,p:t})}_unserializeJsonCommandMessageFromReceived(e){let t;try{t=JSON.parse(e)}catch(t){return void b.err(`Couldn't parse command message! Error:\n${t}\n Full message contents:\n${e}`,"RaviCommandController")}return t&&t.c&&t.p?{command:t.c,payload:t.p}:(b.err("Message cannot be unserialized into a CommandMessage: "+e,"RaviCommandController"),null)}_sendCommandInstance(e){try{let t=e._command;return"string"==typeof t?(t=this._serializeJsonCommandMessageToSend(e._command,e._param),b.log("Sending command "+t,"RaviCommandController")):b.log("Sending binary command","RaviCommandController"),this._commandDataChannel.send(t),!0}catch(e){return b.err("Received error while sending: "+e.message,"RaviCommandController"),!1}}_processListeningCommand(e){let t=e.data,i=null;t&&("string"==typeof t?(i=this._unserializeJsonCommandMessageFromReceived(t),this._continueProcessingListeningCommand(i)):t instanceof ArrayBuffer?(i={command:A,payload:new Uint8Array(t)},this._continueProcessingListeningCommand(i)):t instanceof Blob&&t.arrayBuffer().then((e=>{i={command:A,payload:new Uint8Array(e)},this._continueProcessingListeningCommand(i)})))}_continueProcessingListeningCommand(e){if(e){b.log("_continueProcessingListeningCommand: "+e,"RaviCommandController");var t=this._commandQueueMap.get(e.command);if(t){var i=t.listener.length;if(i>0)if(t.listener[0]&&t.listener[0]._hasMatchingSentCommand){var n=t.listener.shift();if(n&&n._handler)return void n._handler(e.payload);b.err("Undefined command handler: "+e,"RaviCommandController")}else{for(var a=[],s=0;s<i;s++){var o=t.listener[s];o&&o._handler?o._handler(e.payload):b.err("Undefined message handler: "+e,"RaviCommandController"),o&&o._isSticky&&a.push(o)}t.listener=a}}}else b.err("Received invalid command message, ignoring: "+JSON.stringify(e),"RaviCommandController")}_setInputDataChannel(e){this._inputDataChannel=e,b.log("Received new input data channel with id "+this._inputDataChannel.id,"RaviCommandController"),this._inputDataChannel.onopen=function(){b.log("_inputDataChannel onopen, state is "+this._inputDataChannel.readyState,"RaviCommandController")}.bind(this),this._inputDataChannel.onclose=function(){b.log("_inputDataChannel onclose, state is "+this._inputDataChannel.readyState,"RaviCommandController")}.bind(this),this._inputDataChannel.onmessage=function(e){b.log("_inputDataChannel got message: "+e.data,"RaviCommandController")}.bind(this)}_setCommandDataChannel(e){this._commandDataChannel=e,b.log("Received new data channel with id "+this._commandDataChannel.id,"RaviCommandController"),this._commandDataChannel.onopen=function(){b.log("_commandDataChannel ononpen, state is "+this._commandDataChannel.readyState,"RaviCommandController"),this.monitorQueues()}.bind(this),this._commandDataChannel.onclose=function(){b.log("_commandDataChannel onclose, state is "+this._commandDataChannel.readyState,"RaviCommandController"),this.stopMonitoringQueues()}.bind(this),this._commandDataChannel.onmessage=function(e){this._processListeningCommand(e)}.bind(this)}setInputTarget(e){if(this._inputTarget&&(this._inputTarget.onmousemove=null,this._inputTarget.onmouseenter=null,this._inputTarget.onmouseleave=null,this._inputTarget.onmousedown=null,this._inputTarget.onmouseup=null,this._inputTarget.onwheel=null),this._inputTarget=e,this._inputTarget){var t=this;this._inputTarget.onmousemove=function(e){t._trackMouse(e)},this._inputTarget.onmouseenter=null,this._inputTarget.onmouseleave=null,this._inputTarget.onmousedown=function(e){t._captureMouseDown(e)},this._inputTarget.onmouseup=function(e){t._resetMouseDown(e)},this._inputTarget.onwheel=function(e){t._wheelMouse(e)}}}setKeyboardTarget(e){if(this._keyboardTarget&&(this._keyboardTarget.onkeydown=null,this._keyboardTarget.onkeyup=null),this._keyboardTarget=e,this._keyboardTarget){var t=this;this._keyboardTarget.onkeydown=function(e){t._onKeyboardDown(e)},this._keyboardTarget.onkeyup=function(e){t._onKeyboardUp(e)}}}_captureMouseDown(e){this._mouseStateFloat[0]=e.offsetX,this._mouseStateFloat[1]=e.offsetY,this._mouseStateFloat[2]=e.offsetX,this._mouseStateFloat[3]=e.offsetY,this._mouseStateUint8[1]=e.buttons,this._sendMouseState()}_resetMouseDown(e){this._mouseStateFloat[0]=-1,this._mouseStateFloat[1]=-1,this._mouseStateFloat[2]=-1,this._mouseStateFloat[3]=-1,this._mouseStateUint8[1]=e.buttons,this._sendMouseState()}_trackMouse(e){this._mouseStateFloat[0]=e.offsetX,this._mouseStateFloat[1]=e.offsetY,this._mouseStateFloat[4]=this._inputTarget.offsetWidth,this._mouseStateFloat[5]=this._inputTarget.offsetHeight,this._mouseStateUint8[1]=e.buttons,this._sendMouseState()}_wheelMouse(e){this._mouseStateFloat[6]=e.deltaY,this._sendMouseState(),this._mouseStateFloat[6]=0}_sendMouseState(){this.sendInput(this._mouseStateBuffer)}_keyByteNum(e){return e>>3}_keyBitMask(e){return 1<<e%8}_onKeyboardDown(e){let t=y[e.code],i=1+this._keyByteNum(t),n=this._keyBitMask(t);0==(this._keyboardState[i]&n)&&(this._keyboardState[i]|=n,this._sendKeyboardState())}_onKeyboardUp(e){let t=y[e.code],i=1+this._keyByteNum(t),n=this._keyBitMask(t);0!=(this._keyboardState[i]&n)&&(this._keyboardState[i]^=n,this._sendKeyboardState())}_sendKeyboardState(){this.sendInput(this._keyboardStateBuffer)}}class D{constructor(e,t,i){b.log("constructor","RaviCommandInstance"),this._command=e,this._param=t,this._handler=i}}class I{constructor(e,t,i){b.log("constructor","RaviCommandHandlerInstance"),this._handler=e,this._isSticky=t,this._hasMatchingSentCommand=i}}var k,R=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};!function(e){e.NEW="new",e.CONNECTING="checking",e.CONNECTED="connected",e.COMPLETED="completed",e.DISCONNECTED="disconnected",e.FAILED="failed",e.CLOSED="closed"}(k||(k={}));class T{constructor(){b.log("Constructor","RaviSession"),this._stateChangeHandlers=new Set,this._uuid=b.createUUID(),this._commandController=new x,this._streamController=new C(this._commandController),this._state=k.CLOSED,this._raviImplementation=new H(this);const e=this._raviImplementation;this._streamController.setInputAudioChangeHandler(e._addAudioInputStream.bind(e)),this._streamController.setInputVideoChangeHandler(e._addVideoInputStream.bind(e))}getState(){return this._state}getUUID(){return this._uuid}addStateChangeHandler(e){try{return this._stateChangeHandlers.add(e),!0}catch(e){return b.err("Error adding a state change handler: "+e.message,"RaviSession"),!1}return!1}removeStateChangeHandler(e){try{return this._stateChangeHandlers.delete(e),!0}catch(e){return b.err("Error removing a state change handler: "+e.message,"RaviSession"),!1}return!1}getCommandController(){return this._commandController}getStreamController(){return this._streamController}openRAVISession({signalingConnection:e,timeout:t=5e3,params:i=null}){var n=this;return this._raviImplementation._assignSignalingConnection(e),new Promise(((e,a)=>{b.log("Opening RAVI session","RaviSession");let s=setTimeout((()=>{b.log("RaviSession.open timed out after "+t+" ms","RaviSession"),a(Error("RaviSession.open timed out")),n.closeRAVISession()}),t);const o=function(t){var i="";t&&t.state&&(i=t.state),i===k.NEW||i===k.CONNECTING||i===k.DISCONNECTED?b.log("RAVI session state is "+i,"RaviSession"):i===k.CONNECTED||i===k.COMPLETED?(r(),e(i)):i===k.FAILED?(r(),setTimeout((()=>{n._raviImplementation._close()}),0),a(Error(i))):i===k.CLOSED&&(r(),a(Error(i)))},r=function(){n.removeStateChangeHandler(o),s&&(clearTimeout(s),s=null)};n.addStateChangeHandler(o),n._raviImplementation._open(i)}))}closeRAVISession(){var e=this;return this._streamController._stop(),this._commandController.stopMonitoringQueues(),new Promise(((t,i)=>{b.log("Closing RAVI session","RaviSession");const n=function(a){var s="";a&&a.state&&(s=a.state),s===k.DISCONNECTED?b.log("Closing...","RaviSession"):s===k.CLOSED?(e.removeStateChangeHandler(n),t(s)):(e.removeStateChangeHandler(n),i(Error(s)))};e.addStateChangeHandler(n);var a={state:k.DISCONNECTED};e._handleStateChange(a,k.DISCONNECTED),e._raviImplementation._close()}))}_doOntrack(e){b.log("Received new track: ","RaviSession"),b.log(e,"RaviSession"),e&&e.track&&"video"===e.track.kind&&(b.log("Adding remote video track to stream controller","RaviSession"),this._streamController._setVideoStream(e.streams[0]),this._streamController._onVideoStreamStateChanged("ready")),e&&e.track&&"audio"===e.track.kind&&(b.log("Adding remote audio track to stream controller","RaviSession"),this._streamController._setAudioStream(e.streams[0]))}_doOndatachannel(e){switch(b.log("Received new channel: ","RaviSession"),b.log(e,"RaviSession"),e.channel.label){case"ravi.input":this._commandController._setInputDataChannel(e.channel);break;case"ravi.command":this._commandController._setCommandDataChannel(e.channel);break;default:b.log("Received unknown data channel named "+e.channel.label,"RaviSession")}}_handleStateChange(e,t){this._state=t,e&&(e.state=t,b.log("_handleStateChange: "+JSON.stringify(e),"RaviSession"),this._stateChangeHandlers.forEach((function(t){t&&t(e)})))}addStatsObserver(e){return this._raviImplementation._addStatsObserver(e)}removeStatsObserver(e){return this._raviImplementation._removeStatsObserver(e)}}const M=new Map([["remote-inbound-rtp",["id","type","timestamp","roundTripTime","jitter"]],["inbound-rtp",["id","type","timestamp","jitterBufferDelay","jitterBufferEmittedCount","bytesReceived"]]]);class E{constructor(e){b.log("constructor","RaviStatsWatcher"),this._raviImplementation=e,this._observers=new Set,this._filter=M,this._interval=0,this._prevStats=[]}stop(){this._interval&&(window.clearInterval(this._interval),this._interval=0)}addObserver(e){try{return this._observers.add(e),this._onObserverChange(),!0}catch(e){return b.err("Error adding a stats observer: "+e.message,"RaviStatsWatcher"),!1}return!1}removeObserver(e){try{return this._observers.delete(e),this._onObserverChange(),!0}catch(e){return b.err("Error removing a stats observer handler: "+e.message,"RaviSession"),!1}return!1}_onObserverChange(){this._prevStats=[],this._observers.size>0?this._interval||window.setInterval(((e,t)=>R(this,void 0,void 0,(function*(){const e=yield this._raviImplementation._getStats();let t=[];e&&e.forEach((e=>{if(this._filter.has(e.type)){let i=this._filter.get(e.type),n={};i.forEach((t=>{n[t]=e[t]})),t.push(n)}})),t.length&&this._observers.forEach((e=>{e(t,this._prevStats)})),this._prevStats=t}))),1e3):this._interval&&(window.clearInterval(this._interval),this._interval=0)}}let O=null,F=null;"undefined"==typeof self?(O=i(326).I$,F=i(326).Ao):(O=RTCPeerConnection,F=RTCSessionDescription);const P={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"turn:turn.highfidelity.com:3478",username:"clouduser",credential:"chariot-travesty-hook"}]};class H{constructor(e){b.log("constructor","RaviWebRTCImplementation"),this._raviSession=e,this._negotiator=this._setupConnection.bind(this),this._initRtcConnection(),this._statsWatcher=new E(this)}_initRtcConnection(){const e=this._raviSession,t=this;this._rtcConnection=new O(P);const i=this._rtcConnection;i.getSenders().forEach((e=>{e.replaceTrack(null)})),this._raviAudioSenders=[],this._raviVideoSenders=[],i.addEventListener("iceconnectionstatechange",(function(t){e._handleStateChange(t,i.iceConnectionState)})),i.addEventListener("datachannel",(function(t){e._doOndatachannel(t)})),i.addEventListener("track",(function(t){e._doOntrack(t)})),i.addEventListener("icecandidate",(function(e){t._doOnicecandidate(e)})),i.addEventListener("negotiationneeded",(function(e){t._doOnnegotiationneeded(e)})),i.addEventListener("signalingstatechange",(function(e){t._doOnsignalingstatechanged(e)}))}_assignSignalingConnection(e){this._signalingConnection=e}_addAudioInputStream(e){const t=this._rtcConnection;if(e){const i=this._raviAudioSenders,n=e.getAudioTracks(),a=n.length;let s=0;for(;s<i.length;s++)s<a?(b.log("Replacing audio track #"+s+"  in rtcConnection","RaviWebRTCImplementation"),i[s].replaceTrack(n[s])):(b.log("Setting audio sender #"+s+" to null","RaviWebRTCImplementation"),i[s].replaceTrack(null));for(;s<a;s++)b.log("Adding local audio track #"+s+" to rtcConnection","RaviWebRTCImplementation"),i.push(t.addTrack(n[s],e))}else{const e=this._raviAudioSenders;let t=0;for(;t<e.length;t++)b.log("Setting audio sender #"+t+" to null","RaviWebRTCImplementation"),e[t].replaceTrack(null)}return!1}_addVideoInputStream(e){const t=this._rtcConnection;var i=!1;if(e){const n=this._raviVideoSenders,a=e.getVideoTracks();a.length>0?(n.length>0?(b.log("Replacing video track #0 in rtcConnection","RaviWebRTCImplementation"),n[0].replaceTrack(a[0])):(b.log("Adding video track #0 to rtcConnection","RaviWebRTCImplementation"),n.push(t.addTrack(a[0]))),i=!0):b.log("Assigned video stream doesn't contain vidoe track","RaviWebRTCImplementation")}else{const e=this._raviVideoSenders;let t=0;for(;t<e.length;t++)b.log("Setting video sender #"+t+" to null","RaviWebRTCImplementation"),e[t].replaceTrack(null)}return i}_open(e){if(b.log("Attempting to open connection...","RaviWebRTCImplementation"),"connecting"==this._rtcConnection.connectionState||"connected"==this._rtcConnection.connectionState)return b.log("We already have a connection in progress. Will not attempt a new one.","RaviWebRTCImplementation"),void this._raviSession._handleStateChange({state:this._rtcConnection.connectionState},this._rtcConnection.connectionState);if(this._signalingConnection){this._signalingConnection.addMessageHandler(this._negotiator);let t={};e?(t=e,t.sessionID=this._raviSession.getUUID()):t=this._raviSession.getUUID(),this._signalingConnection.send(JSON.stringify({request:t}))}}_close(){if(this._rtcConnection){this._statsWatcher.stop(),b.log("closing","RaviWebRTCImplementation"),this._rtcConnection.close(),this._rtcConnection=null;var e={state:k.CLOSED};this._raviSession._handleStateChange(e,k.CLOSED),this._signalingConnection.removeMessageHandler(this._negotiator),this._initRtcConnection()}}_doOnicecandidate(e){e.candidate&&""!=e.candidate?(b.log("Sending local ICE candidate: "+JSON.stringify(e.candidate),"RaviWebRTCImplementation"),this._signalingConnection.send(JSON.stringify({ice:e.candidate,uuid:this._raviSession.getUUID()}))):b.log("End of local ICE candidates","RaviSession")}_doOnnegotiationneeded(e){b.log("need renegotiation please","RaviWebRTCImplementation");const t={renegotiate:"please",uuid:this._raviSession.getUUID()},i=JSON.stringify(t);this._signalingConnection&&"stable"===this._rtcConnection.signalingState&&this._signalingConnection.send(i)}_doOnsignalingstatechanged(e){b.log("SignalingState changed: "+this._rtcConnection.signalingState,"RaviWebRTCImplementation")}_forceBitrateUp(e){const t=this._raviSession._streamController.isStereoInput()?128e3:64e3;return e.replace(/a=fmtp:111 /g,"a=fmtp:111 maxaveragebitrate="+t+";")}_forceStereoDown(e){return e.replace(/a=fmtp:111 /g,"a=fmtp:111 maxaveragebitrate=128000;sprop-stereo=1;stereo=1;")}_setupConnection(e){let t="",i="";const n=this._raviSession,a=this._rtcConnection,s=this._signalingConnection,o=this;if(n&&a&&s)if(e&&e.data){if(b.log("Message from server: "+e.data,"RaviWebRTCImplementation"),t=JSON.parse(e.data),i=t[n.getUUID()],i)if(i.sdp){b.log("Got sdp of type:"+i.type,"RaviWebRTCImplementation"),i.sdp=o._forceBitrateUp(i.sdp);const e=new F(i);a.setRemoteDescription(e).then((function(){return a.createAnswer()})).then((function(e){return e.sdp=o._forceStereoDown(e.sdp),b.log("Answer:","RaviWebRTCImplementation"),b.log(e,"RaviWebRTCImplementation"),a.setLocalDescription(e)})).then((function(){const e={type:"answer",sdp:a.localDescription,uuid:n.getUUID()},t=JSON.stringify(e);b.log("Sending answer to server","RaviWebRTCImplementation"),s.send(t)}))}else i.ice?(b.log("Received remote ICE candidate: "+JSON.stringify(i.ice),"RaviWebRTCImplementation"),a.addIceCandidate(i.ice).then((function(){b.log("Added remote candidate","RaviWebRTCImplementation")})).catch((function(e){b.err("Error attempting to add remote ICE candidate: "+e.message,"RaviWebRTCImplementation")}))):b.log("Unknown message "+JSON.stringify(i),"RaviWebRTCImplementation")}else b.log("No message received by onMessage handler","RaviWebRTCImplementation");else b.err("Missing one of raviSession, rtcConnection, or signalingConnection! Can't set up connection.","RaviWebRTCImplementation")}_addStatsObserver(e){return this._statsWatcher.addObserver(e)}_removeStatsObserver(e){return this._statsWatcher.removeObserver(e)}_getStats(e=null){return R(this,void 0,void 0,(function*(){return this._rtcConnection?this._rtcConnection.getStats(e):{}}))}}var N;!function(e){e.CONNECTING="connecting",e.OPEN="open",e.ERROR="error",e.CLOSING="closing",e.CLOSED="closed",e.UNAVAILABLE="unavailable"}(N||(N={}));class U{constructor(){b.log("Constructor","RaviSignalingConnection"),this._stateChangeHandlers=new Set,this._messageHandlers=new Set,this._state=N.CLOSED,this._signalingImplementation=new L(this)}getState(){return this._state}addStateChangeHandler(e){try{return this._stateChangeHandlers.add(e),!0}catch(e){return b.err("Error adding a state change handler: "+e.message,"RaviSignalingConnection"),!1}return!1}removeStateChangeHandler(e){try{return this._stateChangeHandlers.delete(e),!0}catch(e){return b.err("Error removing a state change handler: "+e.message,"RaviSignalingConnection"),!1}return!1}addMessageHandler(e){try{return this._messageHandlers.add(e),!0}catch(e){return b.err("Error adding a message handler: "+e.message,"RaviSignalingConnection"),!1}return!1}removeMessageHandler(e){try{return this._messageHandlers.delete(e),!0}catch(e){return b.err("Error removing a state change handler: "+e.message,"RaviSignalingConnection"),!1}return!1}openRAVISignalingConnection(e){var t=this;return new Promise(((i,n)=>{b.log("Opening signaling connection to "+e,"RaviSignalingController");const a=function(e){var s="";e&&e.state&&(s=e.state),s===N.CONNECTING?b.log("Connecting...","RaviSignalingController"):s===N.OPEN?(t.removeStateChangeHandler(a),i(s)):(t.removeStateChangeHandler(a),n(e.error||new Error(e.message||s)))};t.addStateChangeHandler(a);var s={state:N.CONNECTING};this._handleStateChange(s,N.CONNECTING),this._signalingImplementation._open(e)}))}send(e){this._signalingImplementation._send(e)}closeRAVISignalingConnection(){var e=this;return new Promise(((t,i)=>{b.log("Closing signaling connection","RaviSignalingConnection");const n=function(a){var s="";a&&a.state&&(s=a.state),s===N.CLOSING?b.log("Closing...","RaviSignalingConnection"):s===N.CLOSED?(e.removeStateChangeHandler(n),t(s)):(e.removeStateChangeHandler(n),i(Error(s)))};e.addStateChangeHandler(n);var a={state:N.CLOSING};this._handleStateChange(a,N.CLOSING),this._signalingImplementation._close()}))}_handleStateChange(e,t){this._state=t,e.state=t,b.log("_handleStateChange: "+b.safelyPrintable(e),"RaviSignalingConnection"),this._stateChangeHandlers.forEach((function(t){t&&t(e)}))}_handleMessage(e){if(b.log("_doOnmessage: "+b.safelyPrintable(e),"RaviSignalingConnection"),e.data)try{let t=JSON.parse(e.data);t.error&&"service-unavailable"==t.error&&this._handleStateChange({},N.UNAVAILABLE)}catch(e){}this._messageHandlers.forEach((function(t){t&&t(e)}))}}let z=null;z="undefined"==typeof self?i(26):WebSocket;class L{constructor(e){b.log("constructor","RaviSignalingWebSocketImplementation"),this._raviSignalingConnection=e}_open(e){this._webSocket=new z(e);var t=this._raviSignalingConnection;this._webSocket.addEventListener("open",(function(e){t._handleStateChange(e,N.OPEN)})),this._webSocket.addEventListener("error",(function(e){t._handleStateChange(e,N.ERROR)})),this._webSocket.addEventListener("close",(function(e){t._handleStateChange(e,N.CLOSED)})),this._webSocket.addEventListener("message",(function(e){t._handleMessage(e)}))}_send(e){this._webSocket&&this._webSocket.readyState===z.OPEN&&(b.log("Sending message to server: "+e,"RaviSignalingWebSocketImplementation"),this._webSocket.send(e))}_close(){this._webSocket&&(this._webSocket.close(),this._webSocket=null)}}var Q=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};const B=i(591);class Z{constructor({userDataStreamingScope:e=W.All,onUserDataUpdated:t,onUsersDisconnected:i,onConnectionStateChanged:n}){this.webRTCAddress=void 0,this.userDataStreamingScope=e,this.onUserDataUpdated=t,this.onUsersDisconnected=i,this._mixerPeerKeyToStateCacheDict={},b.setDebug(!1),this._raviSignalingConnection=new U,this._raviSignalingConnection.addStateChangeHandler((e=>{this.onRAVISignalingStateChanged(e)})),this._raviSession=new T,this._raviSession.addStateChangeHandler((e=>{this.onRAVISessionStateChanged(e)})),this.onConnectionStateChanged=n,this._resetMixerInfo()}promiseToRunAudioInit(){return Q(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{let i={primary:!0,visit_id:this._raviSession.getUUID(),session:this._raviSession.getUUID(),streaming_scope:this.userDataStreamingScope,is_input_stream_stereo:this._inputAudioMediaStreamIsStereo},n=this._raviSession.getCommandController();if(!n)return Promise.reject({success:!1,error:"Couldn't connect to mixer: no `commandController`!"});let a=setTimeout((()=>(this.disconnectFromHiFiMixer(),Promise.reject({success:!1,error:"Couldn't connect to mixer: Call to `init` timed out!"}))),5e3);n.queueCommand("audionet.init",i,(i=>Q(this,void 0,void 0,(function*(){let n;clearTimeout(a);try{n=JSON.parse(i),this.mixerInfo.connected=!0,this.mixerInfo.build_number=n.build_number,this.mixerInfo.build_type=n.build_type,this.mixerInfo.build_version=n.build_version,this.mixerInfo.visit_id_hash=n.visit_id_hash,e({success:!0,audionetInitResponse:n})}catch(e){t({success:!1,error:`Couldn't parse init response! Parse error:\n${e}`})}}))))}))}))}setOtherUserGainForThisConnection(e,t){return Q(this,void 0,void 0,(function*(){return new Promise(((i,n)=>{let a={visit_id_hash:e,gain:t},s=this._raviSession.getCommandController();s||n({success:!1,error:"Couldn't send personal volume adjust signal to mixer: no `commandController`!"});let o=setTimeout((()=>{n({success:!1,error:"Couldn't send personal volume adjust signal to mixer: Call to `personal_volume_adjust` timed out!"})}),5e3);s.queueCommand("audionet.personal_volume_adjust",a,(e=>Q(this,void 0,void 0,(function*(){let t;clearTimeout(o);try{t=JSON.parse(e),!0===t.success?i({success:!0,audionetSetOtherUserGainForThisConnectionResponse:t}):n({success:!1,error:`Mixer could not adjust the personal volume of another user. Mixer error:\n${t.reason}`,audionetSetOtherUserGainForThisConnectionResponse:t})}catch(e){n({success:!1,error:`Couldn't parse adjust personal volume response! Parse error:\n${e}`})}}))))}))}))}handleRAVISessionBinaryData(e){let t=B.ungzip(e,{to:"string"}),i=JSON.parse(t);if(i.deleted_visit_ids){let e=[],t=i.deleted_visit_ids;for(const i of t){let t=i,n=new c({hashedVisitID:t}),a=Object.keys(this._mixerPeerKeyToStateCacheDict);for(const e of a)if(this._mixerPeerKeyToStateCacheDict[e].hashedVisitID===t){this._mixerPeerKeyToStateCacheDict[e].providedUserID&&(n.providedUserID=this._mixerPeerKeyToStateCacheDict[e].providedUserID);break}e.push(n)}this.onUsersDisconnected&&e.length>0&&this.onUsersDisconnected(e)}if(i.peers){let e=[],t=Object.keys(i.peers);for(let n=0;n<t.length;n++){let a,r=i.peers[t[n]];this._mixerPeerKeyToStateCacheDict[t[n]]?a=this._mixerPeerKeyToStateCacheDict[t[n]]:(a=new c,this._mixerPeerKeyToStateCacheDict[t[n]]=a);let l=new c;a.providedUserID?l.providedUserID=a.providedUserID:"string"==typeof r.J&&(a.providedUserID=r.J,l.providedUserID=r.J),a.hashedVisitID?l.hashedVisitID=a.hashedVisitID:"string"==typeof r.e&&(a.hashedVisitID=r.e,l.hashedVisitID=r.e);let d=!1,h=!1;"number"!=typeof r.x||a.position&&r.x===a.position.x||(a.position||(a.position=new s),a.position.x=r.x/1e3,h=!0),"number"!=typeof r.y||a.position&&r.y===a.position.y||(a.position||(a.position=new s),a.position.y=r.y/1e3,h=!0),"number"!=typeof r.z||a.position&&r.z===a.position.z||(a.position||(a.position=new s),a.position.z=r.z/1e3,h=!0),h&&(l.position=w.translatePoint3DFromMixerSpace(v,a.position),d=!0);let u=!1;"number"!=typeof r.W||a.orientationQuat&&r.W===a.orientationQuat.w||(a.orientationQuat||(a.orientationQuat=new o),a.orientationQuat.w=r.W/1e3,u=!0),"number"!=typeof r.X||a.orientationQuat&&r.X===a.orientationQuat.x||(a.orientationQuat||(a.orientationQuat=new o),a.orientationQuat.x=r.X/1e3,u=!0),"number"!=typeof r.Y||a.orientationQuat&&r.Y===a.orientationQuat.y||(a.orientationQuat||(a.orientationQuat=new o),a.orientationQuat.y=r.Y/1e3,u=!0),"number"!=typeof r.Z||a.orientationQuat&&r.Z===a.orientationQuat.z||(a.orientationQuat||(a.orientationQuat=new o),a.orientationQuat.z=r.Z/1e3,u=!0),u&&(l.orientationQuat=w.translateOrientationQuat3DFromMixerSpace(v,a.orientationQuat),d=!0),"number"==typeof r.g&&r.g!==a.hiFiGain&&(a.hiFiGain=r.g,l.hiFiGain=r.g,d=!0),"number"==typeof r.v&&r.v!==a.volumeDecibels&&(a.volumeDecibels=r.v,l.volumeDecibels=r.v,d=!0),"boolean"==typeof r.s&&r.s!==a.isStereo&&(a.isStereo=r.s,l.isStereo=r.s,d=!0),d&&e.push(l)}this.onUserDataUpdated&&e.length>0&&this.onUserDataUpdated(e)}}connectToHiFiMixer({webRTCSessionParams:e}){return Q(this,void 0,void 0,(function*(){if(!this.webRTCAddress){let e="Couldn't connect: `this.webRTCAddress` is falsey!";return this.disconnectFromHiFiMixer(),Promise.reject(e)}this._currentHiFiConnectionState=void 0;let t=!1;const i=e=>{e&&e.state===N.UNAVAILABLE&&(t=!0,this._raviSignalingConnection.removeStateChangeHandler(i),this._raviSession.closeRAVISession())};this._raviSignalingConnection.addStateChangeHandler(i);try{yield this._raviSignalingConnection.openRAVISignalingConnection(this.webRTCAddress)}catch(e){let t=`Couldn't open signaling connection to \`${this.webRTCAddress.slice(0,this.webRTCAddress.indexOf("token="))}<token redacted>\`! Error:\n${e}`;return this.disconnectFromHiFiMixer(),this._raviSignalingConnection.removeStateChangeHandler(i),Promise.reject(t)}try{yield this._raviSession.openRAVISession({signalingConnection:this._raviSignalingConnection,params:e})}catch(e){let n=`Couldn't open RAVI session associated with \`${this.webRTCAddress.slice(0,this.webRTCAddress.indexOf("token="))}<token redacted>\`! Error:\n${e}`;return t&&(n="High Fidelity server is at capacity; service is unavailable."),this.disconnectFromHiFiMixer(),this._raviSignalingConnection.removeStateChangeHandler(i),Promise.reject(n)}let n;try{n=yield this.promiseToRunAudioInit()}catch(e){let t=`\`audionet.init\` command failed! Error:\n${e.error}`;return this.disconnectFromHiFiMixer(),this._raviSignalingConnection.removeStateChangeHandler(i),Promise.reject(t)}return this._raviSignalingConnection.removeStateChangeHandler(i),this._raviSession.getCommandController().addBinaryHandler((e=>{this.handleRAVISessionBinaryData(e)}),!0),Promise.resolve(n)}))}disconnectFromHiFiMixer(){return Q(this,void 0,void 0,(function*(){function e(e,t,i){return Q(this,void 0,void 0,(function*(){if(e){let n=e.getState();if(e&&n!==i)try{e instanceof U?yield e.closeRAVISignalingConnection():e instanceof T&&(yield e.closeRAVISession()),f.M.log(`The RAVI ${t} closed successfully from state ${n}.`)}catch(e){f.M.warn(`The RAVI ${t} didn't close successfully from state ${n}! Error:\n${e}`)}else f.M.log(`The RAVI ${t} was already closed.`)}else f.M.warn(`The RAVI ${t} was missing.`);e=null}))}return yield e(this._raviSignalingConnection,"Signaling Connection",N.CLOSED),yield e(this._raviSession,"Session",k.CLOSED),this._resetMixerInfo(),Promise.resolve("Successfully disconnected.")}))}setRAVIInputAudio(e,t=!1){return Q(this,void 0,void 0,(function*(){let i=!1;if(this._raviSession){let n=this._raviSession.getStreamController();n?(n.setInputAudio(e,t),f.M.log("Successfully set input audio on _raviSession.streamController!"),i=!0):(f.M.warn("Couldn't set input audio on _raviSession.streamController: No `streamController`!"),i=!1)}else f.M.warn("Couldn't set input audio on _raviSession.streamController: No `_raviSession`!"),i=!1;if(i&&this._inputAudioMediaStreamIsStereo!=t)if(this._raviSession.getState()===k.CONNECTED){let e;f.M.warn(`Stereo status has changed from ${this._inputAudioMediaStreamIsStereo} to ${t}; attempting to re-initialize with the mixer`);try{this._inputAudioMediaStreamIsStereo=t,e=yield this.promiseToRunAudioInit()}catch(e){let t=`Attempt to call \`audionet.init\` for change in stereo status failed! Error:\n${e.error}`;return Promise.reject(t)}}else this._inputAudioMediaStreamIsStereo=t;return i}))}setInputAudioMuted(e,t=!1){return Q(this,void 0,void 0,(function*(){let i=this._raviSession.getStreamController();if(!this._raviSession||!i)return f.M.warn("Couldn't set mute state: No `_raviSession`, or `_raviSession.getStreamController()` returned null."),!1;{let n=!1;if(navigator.permissions&&navigator.permissions.query){let e;try{e=yield navigator.permissions.query({name:"microphone"})}catch(e){}e&&"granted"===e.state&&(n=!0)}if(t&&n&&"undefined"!=typeof self){let t=i._inputAudioStream;if(t&&e)return t.getTracks().forEach((e=>{this._cachedMediaTrackConstraints=e.getConstraints(),e.stop()})),i.setInputAudio(null),f.M.log("Successfully set mute state to `true` by stopping all input media tracks!"),!0;if(!t&&!e){let e=yield navigator.mediaDevices.getUserMedia({audio:this._cachedMediaTrackConstraints,video:!1});return i.setInputAudio(e),f.M.log("Successfully set mute state to `false` by getting new input media stream!"),!0}if(t&&!e)return t.getTracks().forEach((e=>{e.enabled=!0})),f.M.log("Successfully set mute state to `false` by enabling all tracks on `_raviSession.streamController._inputAudioStream`!"),!0;f.M.warn("Couldn't set mute state: No `_inputAudioStream` on `_raviSession.streamController`.")}else{let t=i._inputAudioStream;if(t)return t.getTracks().forEach((t=>{t.enabled=!e})),f.M.log(`Successfully set mute state to ${e} on _raviSession.streamController._inputAudioStream`),!0;f.M.warn("Couldn't set mute state: No `_inputAudioStream` on `_raviSession.streamController`.")}}}))}getOutputAudioMediaStream(){if(!this._raviSession)return null;let e=this._raviSession.getStreamController();return e?e.getAudioStream():null}onRAVISignalingStateChanged(e){switch(f.M.log(`New RAVI signaling state: \`${e.state}\``),e.state){case N.UNAVAILABLE:this._currentHiFiConnectionState=$.Unavailable,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState),this.disconnectFromHiFiMixer()}}onRAVISessionStateChanged(e){switch(f.M.log(`New RAVI session state: \`${e.state}\``),e.state){case k.CONNECTED:this._mixerPeerKeyToStateCacheDict={},this._currentHiFiConnectionState=$.Connected,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState);break;case k.DISCONNECTED:if(this._currentHiFiConnectionState===$.Unavailable)break;this._currentHiFiConnectionState=$.Disconnected,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState),this.disconnectFromHiFiMixer();break;case k.FAILED:if(this._currentHiFiConnectionState===$.Unavailable)break;this._currentHiFiConnectionState=$.Failed,this.onConnectionStateChanged&&this.onConnectionStateChanged(this._currentHiFiConnectionState)}}startCollectingWebRTCStats(e){this._raviSession?(this._statsObserverCallback&&this.stopCollectingWebRTCStats(),this._statsObserverCallback=e,this._raviSession.addStatsObserver(this._statsObserverCallback)):f.M.error("Couldn't start collecting WebRTC stats: No `_raviSession`!")}stopCollectingWebRTCStats(){this._raviSession?(this._raviSession.removeStatsObserver(this._statsObserverCallback),this._statsObserverCallback=void 0):f.M.error("Couldn't stop collecting WebRTC stats: No `_raviSession`!")}_transmitHiFiAudioAPIDataToServer(e,t){if(!this.mixerInfo.connected||!this._raviSession)return{success:!1,error:"Can't transmit data to mixer; not connected to mixer."};let i={};if(e.position&&"number"==typeof e.position.x&&"number"==typeof e.position.y&&"number"==typeof e.position.z){let n={x:!1,y:!1,z:!1,changed:!1};if(t&&t.position?(e.position.x!==t.position.x&&(n.x=!0,n.changed=!0),e.position.y!==t.position.y&&(n.y=!0,n.changed=!0),e.position.z!==t.position.z&&(n.z=!0,n.changed=!0)):(n.x=!0,n.y=!0,n.z=!0,n.changed=!0),n.changed){let t=w.translatePoint3DToMixerSpace(v,e.position);n.x&&(i.x=Math.round(1e3*t.x)),n.y&&(i.y=Math.round(1e3*t.y)),n.z&&(i.z=Math.round(1e3*t.z))}}if(e.orientationQuat&&"number"==typeof e.orientationQuat.w&&"number"==typeof e.orientationQuat.x&&"number"==typeof e.orientationQuat.y&&"number"==typeof e.orientationQuat.z){let n={w:!1,x:!1,y:!1,z:!1,changed:!1};if(t&&t.orientationQuat?(e.orientationQuat.w!==t.orientationQuat.w&&(n.w=!0,n.changed=!0),e.orientationQuat.x!==t.orientationQuat.x&&(n.x=!0,n.changed=!0),e.orientationQuat.y!==t.orientationQuat.y&&(n.y=!0,n.changed=!0),e.orientationQuat.z!==t.orientationQuat.z&&(n.z=!0,n.changed=!0)):(n.w=!0,n.x=!0,n.y=!0,n.z=!0,n.changed=!0),n.changed){let t=w.translateOrientationQuat3DToMixerSpace(v,e.orientationQuat);n.w&&(i.W=1e3*t.w),n.x&&(i.X=1e3*t.x),n.y&&(i.Y=1e3*t.y),i.Z=1e3*t.z}}if("number"==typeof e.volumeThreshold&&(i.T=e.volumeThreshold),"number"==typeof e.hiFiGain&&(i.g=Math.max(0,e.hiFiGain)),"number"==typeof e.userAttenuation&&(i.a=e.userAttenuation),"number"==typeof e.userRolloff&&(i.r=Math.max(0,e.userRolloff)),0===Object.keys(i).length)return{success:!0,stringifiedDataForMixer:JSON.stringify({})};{let e=this._raviSession.getCommandController();if(e){let t=JSON.stringify(i);return e.sendInput(t),{success:!0,stringifiedDataForMixer:t}}return{success:!1,error:"Can't transmit data to mixer; no `commandController`!."}}}_resetMixerInfo(){this.mixerInfo={connected:!1}}}var K;!function(e){e.Position="Position",e.OrientationEuler="Orientation (Euler)",e.OrientationQuat="Orientation (Quaternion)",e.VolumeDecibels="Volume (Decibels)",e.HiFiGain="HiFiGain",e.IsStereo="IsStereo"}(K||(K={}));class V{constructor({providedUserID:e=null,components:t,callback:i}){this.providedUserID=e,this.components=t,this.callback=i}}var $,W,Y=function(e,t,i,n){return new(i||(i=Promise))((function(a,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function r(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,r)}l((n=n.apply(e,t||[])).next())}))};!function(e){e.Connected="Connected",e.Disconnected="Disconnected",e.Failed="Failed",e.Unavailable="Unavailable"}($||($={})),function(e){e.None="none",e.Peers="peers",e.All="all"}(W||(W={}));class j{constructor({initialHiFiAudioAPIData:e=new u,onConnectionStateChanged:t,onUsersDisconnected:i,transmitRateLimitTimeoutMS:n=_.DEFAULT_TRANSMIT_RATE_LIMIT_TIMEOUT_MS,userDataStreamingScope:s=W.All,hiFiAxisConfiguration:o,webrtcSessionParams:r}={}){this._timers={transmitRateLimitTimeout:null,wantedToTransmitHiFiAudioAPIData:!0},n<_.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS&&(f.M.warn(`\`transmitRateLimitTimeoutMS\` must be >= ${_.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS}ms! Setting to ${_.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS}ms...`),n=_.MIN_TRANSMIT_RATE_LIMIT_TIMEOUT_MS),this.transmitRateLimitTimeoutMS=n,i&&(this.onUsersDisconnected=i),this._mixerSession=new Z({userDataStreamingScope:s,onUserDataUpdated:e=>{this._handleUserDataUpdates(e)},onUsersDisconnected:e=>{this._onUsersDisconnected(e)},onConnectionStateChanged:t}),this._inputAudioMediaStream=void 0,this._currentHiFiAudioAPIData=new u,this._lastTransmittedHiFiAudioAPIData=new u,this._userDataSubscriptions=[],r&&r.audioMinJitterBufferDuration&&(r.audioMinJitterBufferDuration<0||r.audioMinJitterBufferDuration>10)&&(f.M.warn(`The value of \`webrtcSessionParams.audioMinJitterBufferDuration\` (${r.audioMinJitterBufferDuration}) will be clamped to (0.0, 10.0).`),r.audioMinJitterBufferDuration=a.H.clamp(r.audioMinJitterBufferDuration,0,10)),r&&r.audioMaxJitterBufferDuration&&(r.audioMaxJitterBufferDuration<0||r.audioMaxJitterBufferDuration>10)&&(f.M.warn(`The value of \`webrtcSessionParams.audioMaxJitterBufferDuration\` (${r.audioMaxJitterBufferDuration}) will be clamped to (0.0, 10.0).`),r.audioMaxJitterBufferDuration=a.H.clamp(r.audioMaxJitterBufferDuration,0,10)),this._webRTCSessionParams=r,o&&(w.verify(o)?(v.rightAxis=o.rightAxis,v.leftAxis=o.leftAxis,v.intoScreenAxis=o.intoScreenAxis,v.outOfScreenAxis=o.outOfScreenAxis,v.upAxis=o.upAxis,v.downAxis=o.downAxis,v.handedness=o.handedness,v.eulerOrder=o.eulerOrder):f.M.error("There is an error with the passed `HiFiAxisConfiguration`, so the new axis configuration was not set. There are more error details in the logs above.")),this._updateUserData(e)}connectToHiFiAudioAPIServer(e,t,i){return Y(this,void 0,void 0,(function*(){if(!this._mixerSession){let e="`this._mixerSession` is falsey!";return Promise.reject({success:!1,error:e})}let n,a;try{a=new URL(t).hostname}catch(e){a=t||_.DEFAULT_PROD_HIGH_FIDELITY_ENDPOINT}i=i||_.DEFAULT_PROD_HIGH_FIDELITY_PORT;try{let t=`wss://${a}:${i}/?token=`;this._mixerSession.webRTCAddress=`${t}${e}`,f.M.log(`Using WebRTC Signaling Address:\n${t}<token redacted>`),n=yield this._mixerSession.connectToHiFiMixer({webRTCSessionParams:this._webRTCSessionParams})}catch(e){let t=`Error when connecting to mixer! Error:\n${e}`;return Promise.reject({success:!1,error:t})}return this._transmitHiFiAudioAPIDataToServer(!0),Promise.resolve({success:!0,audionetInitResponse:n.audionetInitResponse})}))}setOtherUserGainForThisConnection(e,t){return Y(this,void 0,void 0,(function*(){let i;if(!this._mixerSession){let e="`this._mixerSession` is falsey!";return Promise.reject({success:!1,error:e})}try{i=yield this._mixerSession.setOtherUserGainForThisConnection(e,t)}catch(e){let t;t=e.error?e.error:JSON.stringify(e);let i=`Error when setting other user gain for this connection. Error: \n${t}`;return Promise.reject({success:!1,error:i,audionetSetOtherUserGainForThisConnectionResponse:e.audionetSetOtherUserGainForThisConnectionResponse})}return Promise.resolve({success:!0,audionetSetOtherUserGainForThisConnectionResponse:i.audionetSetOtherUserGainForThisConnectionResponse})}))}disconnectFromHiFiAudioAPIServer(){return Y(this,void 0,void 0,(function*(){return this._mixerSession?(this._inputAudioMediaStream=void 0,this.onUsersDisconnected=void 0,this._userDataSubscriptions=[],this._currentHiFiAudioAPIData=void 0,this._lastTransmittedHiFiAudioAPIData=new u,this._mixerSession.disconnectFromHiFiMixer()):Promise.resolve("No mixer session from which we can disconnect!")}))}getOutputAudioMediaStream(){return this._mixerSession?this._mixerSession.getOutputAudioMediaStream():null}setInputAudioMediaStream(e,t=!1){return Y(this,void 0,void 0,(function*(){const i=yield this._mixerSession.setRAVIInputAudio(e,t);return i?this._inputAudioMediaStream=e:f.M.warn("Error trying to setRAVIInputAudio on this._mixerSession"),i}))}setInputAudioMuted(e){return Y(this,void 0,void 0,(function*(){return this._mixerSession?(f.M.debug(`Setting mute state to : ${e}`),yield this._mixerSession.setInputAudioMuted(e)):(f.M.warn("Couldn't set mute state: No `_mixerSession`."),!1)}))}getCommunicatorInfo(){let e={clientInfo:{inputAudioStreamSet:!!this._inputAudioMediaStream}};return"undefined"!=typeof self&&(e.clientInfo.apiVersion="v0.9.2-1"),this._mixerSession&&this._mixerSession.mixerInfo&&(e.serverInfo=this._mixerSession.mixerInfo),e}startCollectingWebRTCStats(e){this._mixerSession||f.M.error("Couldn't start collecting WebRTC Stats: No `_mixerSession`!"),this._mixerSession.startCollectingWebRTCStats(e)}stopCollectingWebRTCStats(){this._mixerSession||f.M.error("Couldn't stop collecting WebRTC Stats: No `_mixerSession`!"),this._mixerSession.stopCollectingWebRTCStats()}_updateUserData({position:e,orientationQuat:t,orientationEuler:i,volumeThreshold:n,hiFiGain:a,userAttenuation:r,userRolloff:h}={}){var u,c,_,m,g,f,p;if(e&&(this._currentHiFiAudioAPIData.position||(this._currentHiFiAudioAPIData.position=new s),this._currentHiFiAudioAPIData.position.x=null!==(u=e.x)&&void 0!==u?u:this._currentHiFiAudioAPIData.position.x,this._currentHiFiAudioAPIData.position.y=null!==(c=e.y)&&void 0!==c?c:this._currentHiFiAudioAPIData.position.y,this._currentHiFiAudioAPIData.position.z=null!==(_=e.z)&&void 0!==_?_:this._currentHiFiAudioAPIData.position.z),t)this._currentHiFiAudioAPIData.orientationQuat||(this._currentHiFiAudioAPIData.orientationQuat=new o),this._currentHiFiAudioAPIData.orientationQuat.w=null!==(m=t.w)&&void 0!==m?m:this._currentHiFiAudioAPIData.orientationQuat.w,this._currentHiFiAudioAPIData.orientationQuat.x=null!==(g=t.x)&&void 0!==g?g:this._currentHiFiAudioAPIData.orientationQuat.x,this._currentHiFiAudioAPIData.orientationQuat.y=null!==(f=t.y)&&void 0!==f?f:this._currentHiFiAudioAPIData.orientationQuat.y,this._currentHiFiAudioAPIData.orientationQuat.z=null!==(p=t.z)&&void 0!==p?p:this._currentHiFiAudioAPIData.orientationQuat.z;else if(i){let e=new l(i);this._currentHiFiAudioAPIData.orientationQuat=d(e,v.eulerOrder)}"number"==typeof n&&(this._currentHiFiAudioAPIData.volumeThreshold=n),"number"==typeof a&&(this._currentHiFiAudioAPIData.hiFiGain=Math.max(0,a)),"number"==typeof r&&(this._currentHiFiAudioAPIData.userAttenuation=r),"number"==typeof h&&(this._currentHiFiAudioAPIData.userRolloff=Math.max(0,h))}_maybeClearRateLimitTimeout(){this._timers.transmitRateLimitTimeout&&clearTimeout(this._timers.transmitRateLimitTimeout),this._timers.transmitRateLimitTimeout=null}_updateLastTransmittedHiFiAudioAPIData(e){var t,i,n,a,r,l,d;e.position&&(this._lastTransmittedHiFiAudioAPIData.position||(this._lastTransmittedHiFiAudioAPIData.position=new s),this._lastTransmittedHiFiAudioAPIData.position.x=null!==(t=e.position.x)&&void 0!==t?t:this._lastTransmittedHiFiAudioAPIData.position.x,this._lastTransmittedHiFiAudioAPIData.position.y=null!==(i=e.position.y)&&void 0!==i?i:this._lastTransmittedHiFiAudioAPIData.position.y,this._lastTransmittedHiFiAudioAPIData.position.z=null!==(n=e.position.z)&&void 0!==n?n:this._lastTransmittedHiFiAudioAPIData.position.z),e.orientationQuat&&(this._lastTransmittedHiFiAudioAPIData.orientationQuat||(this._lastTransmittedHiFiAudioAPIData.orientationQuat=new o),this._lastTransmittedHiFiAudioAPIData.orientationQuat.w=null!==(a=e.orientationQuat.w)&&void 0!==a?a:this._lastTransmittedHiFiAudioAPIData.orientationQuat.w,this._lastTransmittedHiFiAudioAPIData.orientationQuat.x=null!==(r=e.orientationQuat.x)&&void 0!==r?r:this._lastTransmittedHiFiAudioAPIData.orientationQuat.x,this._lastTransmittedHiFiAudioAPIData.orientationQuat.y=null!==(l=e.orientationQuat.y)&&void 0!==l?l:this._lastTransmittedHiFiAudioAPIData.orientationQuat.y,this._lastTransmittedHiFiAudioAPIData.orientationQuat.z=null!==(d=e.orientationQuat.z)&&void 0!==d?d:this._lastTransmittedHiFiAudioAPIData.orientationQuat.z),"number"==typeof e.volumeThreshold&&(this._lastTransmittedHiFiAudioAPIData.volumeThreshold=e.volumeThreshold),"number"==typeof e.hiFiGain&&(this._lastTransmittedHiFiAudioAPIData.hiFiGain=e.hiFiGain),"number"==typeof e.userAttenuation&&(this._lastTransmittedHiFiAudioAPIData.userAttenuation=e.userAttenuation),"number"==typeof e.userRolloff&&(this._lastTransmittedHiFiAudioAPIData.userRolloff=e.userRolloff)}_transmitHiFiAudioAPIDataToServer(e){if(this._mixerSession&&(!this._timers.transmitRateLimitTimeout||e)){this._timers.wantedToTransmitHiFiAudioAPIData=!1,this._maybeClearRateLimitTimeout(),e||(this._timers.transmitRateLimitTimeout=setTimeout((()=>{this._maybeClearRateLimitTimeout(),this._timers.wantedToTransmitHiFiAudioAPIData&&this._transmitHiFiAudioAPIDataToServer(!0)}),this.transmitRateLimitTimeoutMS));let t=this._mixerSession._transmitHiFiAudioAPIDataToServer(this._currentHiFiAudioAPIData,this._lastTransmittedHiFiAudioAPIData);return t.success?(this._updateLastTransmittedHiFiAudioAPIData(this._currentHiFiAudioAPIData),{success:!0,rawDataTransmitted:t.stringifiedDataForMixer}):{success:!1,error:t.error}}return this._mixerSession&&this._timers.transmitRateLimitTimeout&&!e?(this._timers.wantedToTransmitHiFiAudioAPIData=!0,{success:!0,error:"Transfer is rate limited. Transfer will occur shortly automatically."}):this._mixerSession?void 0:{success:!1,error:"No server connection yet; can't transmit user data."}}updateUserDataAndTransmit(e){return this._updateUserData(e),this._transmitHiFiAudioAPIDataToServer()}_handleUserDataUpdates(e){if(0!==this._userDataSubscriptions.length)for(let t=0;t<this._userDataSubscriptions.length;t++){let i=this._userDataSubscriptions[t];if(!i.callback)continue;let n=[];for(let t=0;t<e.length;t++){let a=e[t];if(i.providedUserID&&a.providedUserID!==i.providedUserID)continue;let s=new c;"string"==typeof a.providedUserID&&(s.providedUserID=a.providedUserID),"string"==typeof a.hashedVisitID&&(s.hashedVisitID=a.hashedVisitID);let o=!1;for(let e=0;e<i.components.length;e++)switch(i.components[e]){case K.Position:a.position&&(s.position=a.position,o=!0);break;case K.OrientationQuat:a.orientationQuat&&(s.orientationQuat=a.orientationQuat,o=!0);break;case K.OrientationEuler:a.orientationQuat&&(s.orientationEuler=h(a.orientationQuat,v.eulerOrder),o=!0);break;case K.VolumeDecibels:"number"==typeof a.volumeDecibels&&(s.volumeDecibels=a.volumeDecibels,o=!0);break;case K.HiFiGain:"number"==typeof a.hiFiGain&&(s.hiFiGain=a.hiFiGain,o=!0);break;case K.IsStereo:"boolean"==typeof a.isStereo&&(s.isStereo=a.isStereo,o=!0)}o&&n.push(s)}i.callback&&n.length>0&&i.callback(n)}}_onUsersDisconnected(e){this.onUsersDisconnected&&this.onUsersDisconnected(e)}addUserDataSubscription(e){this._mixerSession?this._mixerSession.userDataStreamingScope!==W.None?(f.M.log(`Adding new User Data Subscription:\n${JSON.stringify(e)}`),this._userDataSubscriptions.push(e)):f.M.error("During `HiFiCommunicator` construction, the server was set up to **not** send user data! Data subscription not added."):f.M.error("No `_mixerSession`! Data subscription not added.")}}"undefined"!=typeof self&&a.H.checkBrowserCompatibility();let G="v0.9.2-1",J=a.H.getBestAudioConstraints,q=a.H.preciseInterval},649:(e,t,i)=>{var n;i.d(t,{D:()=>n,M:()=>a}),function(e){e.None="None",e.Error="Error",e.Warn="Warn",e.Debug="Debug"}(n||(n={}));class a{constructor(e){e=e||n.Debug}static setHiFiLogLevel(e){a.logLevel=e}static log(e){return a.logLevel===n.Debug&&(console.log(e),!0)}static debug(e){return this.log(e)}static warn(e){return(a.logLevel===n.Debug||a.logLevel===n.Warn)&&(console.warn(e),!0)}static error(e){return(a.logLevel===n.Debug||a.logLevel===n.Warn||a.logLevel===n.Error)&&(console.error(e),!0)}}a.logLevel=n.Error},24:(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{H:()=>HiFiUtilities});var _HiFiLogger__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(649);function dynamicRequire(e,t){return e.require(t)}let now;if(module=__webpack_require__.hmd(module),"undefined"==typeof self)try{now=dynamicRequire(module,"perf_hooks").performance.now}catch(e){}class HiFiUtilities{constructor(){}static recursivelyDiffObjects(e,t){if(!t||"[object Object]"!==Object.prototype.toString.call(t))return e;let i,n={},a=(e,t,i)=>{let a=Object.prototype.toString.call(e),s=Object.prototype.toString.call(t);if("[object Undefined]"!==s)if(a===s)if("[object Object]"!==a)"[object Array]"!==a?"[object Function]"===a?e.toString()!==t.toString()&&(n[i]=t):e!==t&&(n[i]=t):((e,t)=>{if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0})(e,t)||(n[i]=t);else{let a=HiFiUtilities.recursivelyDiffObjects(e,t);Object.keys(a).length>0&&(n[i]=a)}else n[i]=t;else n[i]=null};for(i in e)e.hasOwnProperty(i)&&a(e[i],t[i],i);for(i in t)t.hasOwnProperty(i)&&(e[i]||e[i]===t[i]||(n[i]=t[i]));return n}static getBestAudioConstraints(){let e={};return"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().echoCancellation&&(e.echoCancellation=!1),"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().noiseSuppression&&(e.noiseSuppression=!1),"undefined"!=typeof navigator&&void 0!==navigator.mediaDevices&&void 0!==navigator.mediaDevices.getSupportedConstraints&&navigator.mediaDevices.getSupportedConstraints().autoGainControl&&(e.autoGainControl=!1),e}static preciseInterval(e,t){if(!now)return _HiFiLogger__WEBPACK_IMPORTED_MODULE_0__.M.warn("`preciseInterval()` is a wrapper for `setInterval()` in the browser context!"),setInterval(e,t);let i=now(),n=clearTimeout,a=()=>{let o=now();if(o<i)return n=clearImmediate,s=setImmediate(a);i+=t,n=clearTimeout,s=setTimeout(a,i-o-2),e()},s=setTimeout(a);return{clear:()=>n(s)}}static checkBrowserCompatibility(){let requiredFeatures=["navigator","navigator.mediaDevices.getUserMedia","navigator.mediaDevices.getSupportedConstraints","window.MediaStream","window.RTCDataChannel","window.RTCPeerConnection","window.RTCSessionDescription"];for(let i=0;i<requiredFeatures.length;i++)if(void 0===eval(requiredFeatures[i]))return _HiFiLogger__WEBPACK_IMPORTED_MODULE_0__.M.error("HiFi Audio API: The browser does not support: "+requiredFeatures[i]),"navigator.mediaDevices.getUserMedia"===requiredFeatures[i]&&_HiFiLogger__WEBPACK_IMPORTED_MODULE_0__.M.error("HiFi Audio API: Your browser may be preventing access to this feature if you are running in an insecure context, i.e. an `http` server."),!1;return!0}static nonan(e,t){return isNaN(e)?t:e}static clamp(e,t,i){return e>i?i:e<t?t:e}static clampNonan(e,t,i,n){return e>i?i:e<t?t:HiFiUtilities.nonan(e,n)}static clampNormalized(e){return e>1?1:e<-1?-1:e}}},326:(e,t)=>{window.MediaStream,window.MediaStreamTrack,window.RTCDataChannel,window.RTCDataChannelEvent,window.RTCDtlsTransport,window.RTCIceCandidate,window.RTCIceTransport,t.I$=window.RTCPeerConnection,window.RTCPeerConnectionIceEvent,window.RTCRtpReceiver,window.RTCRtpSender,window.RTCRtpTransceiver,window.RTCSctpTransport,t.Ao=window.RTCSessionDescription,window.getUserMedia,navigator.mediaDevices},26:e=>{e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}},__webpack_module_cache__={};function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.loaded=!0,t.exports}return __webpack_require__.d=(e,t)=>{for(var i in t)__webpack_require__.o(t,i)&&!__webpack_require__.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},__webpack_require__.hmd=e=>((e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__(631)})();